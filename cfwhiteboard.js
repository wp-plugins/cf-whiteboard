var JSON;JSON||(JSON={});
(function(){function h(d){return 10>d?"0"+d:d}function b(d){k.lastIndex=0;return k.test(d)?'"'+d.replace(k,function(d){var b=j[d];return"string"===typeof b?b:"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function e(j,i){var h,k,q,r,p=f,l,o=i[j];o&&"object"===typeof o&&"function"===typeof o.toJSON&&(o=o.toJSON(j));"function"===typeof m&&(o=m.call(i,j,o));switch(typeof o){case "string":return b(o);case "number":return isFinite(o)?""+o:"null";case "boolean":case "null":return""+o;
case "object":if(!o)return"null";f+=d;l=[];if("[object Array]"===Object.prototype.toString.apply(o)){r=o.length;for(h=0;h<r;h+=1)l[h]=e(h,o)||"null";q=0===l.length?"[]":f?"[\n"+f+l.join(",\n"+f)+"\n"+p+"]":"["+l.join(",")+"]";f=p;return q}if(m&&"object"===typeof m){r=m.length;for(h=0;h<r;h+=1)"string"===typeof m[h]&&(k=m[h],(q=e(k,o))&&l.push(b(k)+(f?": ":":")+q))}else for(k in o)Object.prototype.hasOwnProperty.call(o,k)&&(q=e(k,o))&&l.push(b(k)+(f?": ":":")+q);q=0===l.length?"{}":f?"{\n"+f+l.join(",\n"+
f)+"\n"+p+"}":"{"+l.join(",")+"}";f=p;return q}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var i=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
k=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,d,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;if("function"!==typeof JSON.stringify)JSON.stringify=function(b,j,i){var h;d=f="";if("number"===typeof i)for(h=0;h<i;h+=1)d+=" ";else"string"===typeof i&&(d=i);if((m=j)&&"function"!==typeof j&&("object"!==typeof j||"number"!==typeof j.length))throw Error("JSON.stringify");return e("",
{"":b})};if("function"!==typeof JSON.parse)JSON.parse=function(d,b){function j(d,e){var i,h,m=d[e];if(m&&"object"===typeof m)for(i in m)Object.prototype.hasOwnProperty.call(m,i)&&(h=j(m,i),void 0!==h?m[i]=h:delete m[i]);return b.call(d,e,m)}var e,d=""+d;i.lastIndex=0;i.test(d)&&(d=d.replace(i,function(d){return"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(d.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+d+")"),"function"===typeof b?j({"":e},""):e;throw new SyntaxError("JSON.parse");}})();(function(){function h(a,n,g){if(a===n)return 0!==a||1/a==1/n;if(null==a||null==n)return a===n;if(a._chain)a=a._wrapped;if(n._chain)n=n._wrapped;if(a.isEqual&&c.isFunction(a.isEqual))return a.isEqual(n);if(n.isEqual&&c.isFunction(n.isEqual))return n.isEqual(a);var d=m.call(a);if(d!=m.call(n))return!1;switch(d){case "[object String]":return a==""+n;case "[object Number]":return a!=+a?n!=+n:0==a?1/a==1/n:a==+n;case "[object Date]":case "[object Boolean]":return+a==+n;case "[object RegExp]":return a.source==
n.source&&a.global==n.global&&a.multiline==n.multiline&&a.ignoreCase==n.ignoreCase}if("object"!=typeof a||"object"!=typeof n)return!1;for(var b=g.length;b--;)if(g[b]==a)return!0;g.push(a);var b=0,j=!0;if("[object Array]"==d){if(b=a.length,j=b==n.length)for(;b--&&(j=b in a==b in n&&h(a[b],n[b],g)););}else{if("constructor"in a!="constructor"in n||a.constructor!=n.constructor)return!1;for(var e in a)if(u.call(a,e)&&(b++,!(j=u.call(n,e)&&h(a[e],n[e],g))))break;if(j){for(e in n)if(u.call(n,e)&&!b--)break;
j=!b}}g.pop();return j}var b=this,e=b._,i={},k=Array.prototype,f=Object.prototype,d=k.slice,j=k.unshift,m=f.toString,u=f.hasOwnProperty,w=k.forEach,x=k.map,v=k.reduce,q=k.reduceRight,r=k.filter,p=k.every,l=k.some,o=k.indexOf,y=k.lastIndexOf,f=Array.isArray,a=Object.keys,g=Function.prototype.bind,c=function(a){return new z(a)};if("undefined"!==typeof exports){if("undefined"!==typeof module&&module.exports)exports=module.exports=c;exports._=c}else"function"===typeof define&&define.amd?define("underscore",
function(){return c}):b._=c;c.VERSION="1.2.4";var t=c.each=c.forEach=function(a,c,g){if(null!=a)if(w&&a.forEach===w)a.forEach(c,g);else if(a.length===+a.length)for(var d=0,b=a.length;d<b&&!(d in a&&c.call(g,a[d],d,a)===i);d++);else for(d in a)if(u.call(a,d)&&c.call(g,a[d],d,a)===i)break};c.map=function(a,c,d){var g=[];if(null==a)return g;if(x&&a.map===x)return a.map(c,d);t(a,function(a,s,b){g[g.length]=c.call(d,a,s,b)});if(a.length===+a.length)g.length=a.length;return g};c.reduce=c.foldl=c.inject=
function(a,g,d,b){var j=2<arguments.length;null==a&&(a=[]);if(v&&a.reduce===v)return b&&(g=c.bind(g,b)),j?a.reduce(g,d):a.reduce(g);t(a,function(a,c,s){j?d=g.call(b,d,a,c,s):(d=a,j=!0)});if(!j)throw new TypeError("Reduce of empty array with no initial value");return d};c.reduceRight=c.foldr=function(a,g,d,b){var j=2<arguments.length;null==a&&(a=[]);if(q&&a.reduceRight===q)return b&&(g=c.bind(g,b)),j?a.reduceRight(g,d):a.reduceRight(g);var e=c.toArray(a).reverse();b&&!j&&(g=c.bind(g,b));return j?c.reduce(e,
g,d,b):c.reduce(e,g)};c.find=c.detect=function(a,c,g){var d;C(a,function(a,s,b){if(c.call(g,a,s,b))return d=a,!0});return d};c.filter=c.select=function(a,c,g){var d=[];if(null==a)return d;if(r&&a.filter===r)return a.filter(c,g);t(a,function(a,s,b){c.call(g,a,s,b)&&(d[d.length]=a)});return d};c.reject=function(a,c,g){var d=[];if(null==a)return d;t(a,function(a,s,b){c.call(g,a,s,b)||(d[d.length]=a)});return d};c.every=c.all=function(a,c,g){var d=!0;if(null==a)return d;if(p&&a.every===p)return a.every(c,
g);t(a,function(a,s,b){if(!(d=d&&c.call(g,a,s,b)))return i});return d};var C=c.some=c.any=function(a,d,g){d||(d=c.identity);var b=!1;if(null==a)return b;if(l&&a.some===l)return a.some(d,g);t(a,function(a,c,s){if(b||(b=d.call(g,a,c,s)))return i});return!!b};c.include=c.contains=function(a,c){var d;return null==a?!1:o&&a.indexOf===o?-1!=a.indexOf(c):d=C(a,function(a){return a===c})};c.invoke=function(a,g){var b=d.call(arguments,2);return c.map(a,function(a){return(c.isFunction(g)?g||a:a[g]).apply(a,
b)})};c.pluck=function(a,d){return c.map(a,function(a){return a[d]})};c.max=function(a,d,g){if(!d&&c.isArray(a))return Math.max.apply(Math,a);if(!d&&c.isEmpty(a))return-Infinity;var b={computed:-Infinity};t(a,function(a,c,s){c=d?d.call(g,a,c,s):a;c>=b.computed&&(b={value:a,computed:c})});return b.value};c.min=function(a,d,g){if(!d&&c.isArray(a))return Math.min.apply(Math,a);if(!d&&c.isEmpty(a))return Infinity;var b={computed:Infinity};t(a,function(a,c,s){c=d?d.call(g,a,c,s):a;c<b.computed&&(b={value:a,
computed:c})});return b.value};c.shuffle=function(a){var c=[],d;t(a,function(a,g){0==g?c[0]=a:(d=Math.floor(Math.random()*(g+1)),c[g]=c[d],c[d]=a)});return c};c.sortBy=function(a,d,g){return c.pluck(c.map(a,function(a,c,s){return{value:a,criteria:d.call(g,a,c,s)}}).sort(function(a,c){var d=a.criteria,g=c.criteria;return d<g?-1:d>g?1:0}),"value")};c.groupBy=function(a,d){var g={},b=c.isFunction(d)?d:function(a){return a[d]};t(a,function(a,c){var d=b(a,c);(g[d]||(g[d]=[])).push(a)});return g};c.sortedIndex=
function(a,d,g){g||(g=c.identity);for(var b=0,j=a.length;b<j;){var e=b+j>>1;g(a[e])<g(d)?b=e+1:j=e}return b};c.toArray=function(a){return!a?[]:a.toArray?a.toArray():c.isArray(a)?d.call(a):c.isArguments(a)?d.call(a):c.values(a)};c.size=function(a){return c.toArray(a).length};c.first=c.head=function(a,c,g){return null!=c&&!g?d.call(a,0,c):a[0]};c.initial=function(a,c,g){return d.call(a,0,a.length-(null==c||g?1:c))};c.last=function(a,c,g){return null!=c&&!g?d.call(a,Math.max(a.length-c,0)):a[a.length-
1]};c.rest=c.tail=function(a,c,g){return d.call(a,null==c||g?1:c)};c.compact=function(a){return c.filter(a,function(a){return!!a})};c.flatten=function(a,d){return c.reduce(a,function(a,g){if(c.isArray(g))return a.concat(d?g:c.flatten(g));a[a.length]=g;return a},[])};c.without=function(a){return c.difference(a,d.call(arguments,1))};c.uniq=c.unique=function(a,g,d){var d=d?c.map(a,d):a,b=[];c.reduce(d,function(d,j,e){if(0==e||(!0===g?c.last(d)!=j:!c.include(d,j)))d[d.length]=j,b[b.length]=a[e];return d},
[]);return b};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=c.intersect=function(a){var g=d.call(arguments,1);return c.filter(c.uniq(a),function(a){return c.every(g,function(d){return 0<=c.indexOf(d,a)})})};c.difference=function(a){var g=c.flatten(d.call(arguments,1));return c.filter(a,function(a){return!c.include(g,a)})};c.zip=function(){for(var a=d.call(arguments),g=c.max(c.pluck(a,"length")),b=Array(g),j=0;j<g;j++)b[j]=c.pluck(a,""+j);return b};c.indexOf=function(a,
d,g){if(null==a)return-1;var b;if(g)return g=c.sortedIndex(a,d),a[g]===d?g:-1;if(o&&a.indexOf===o)return a.indexOf(d);for(g=0,b=a.length;g<b;g++)if(g in a&&a[g]===d)return g;return-1};c.lastIndexOf=function(a,c){if(null==a)return-1;if(y&&a.lastIndexOf===y)return a.lastIndexOf(c);for(var g=a.length;g--;)if(g in a&&a[g]===c)return g;return-1};c.range=function(a,c,g){1>=arguments.length&&(c=a||0,a=0);for(var g=arguments[2]||1,d=Math.max(Math.ceil((c-a)/g),0),b=0,j=Array(d);b<d;)j[b++]=a,a+=g;return j};
var D=function(){};c.bind=function(a,b){var j,e;if(a.bind===g&&g)return g.apply(a,d.call(arguments,1));if(!c.isFunction(a))throw new TypeError;e=d.call(arguments,2);return j=function(){if(!(this instanceof j))return a.apply(b,e.concat(d.call(arguments)));D.prototype=a.prototype;var c=new D,g=a.apply(c,e.concat(d.call(arguments)));return Object(g)===g?g:c}};c.bindAll=function(a){var g=d.call(arguments,1);0==g.length&&(g=c.functions(a));t(g,function(g){a[g]=c.bind(a[g],a)});return a};c.memoize=function(a,
g){var d={};g||(g=c.identity);return function(){var c=g.apply(this,arguments);return u.call(d,c)?d[c]:d[c]=a.apply(this,arguments)}};c.delay=function(a,c){var g=d.call(arguments,2);return setTimeout(function(){return a.apply(a,g)},c)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(d.call(arguments,1)))};c.throttle=function(a,g){var d,b,j,e,i,h=c.debounce(function(){i=e=!1},g);return function(){d=this;b=arguments;j||(j=setTimeout(function(){j=null;i&&a.apply(d,b);h()},g));e?i=!0:a.apply(d,
b);h();e=!0}};c.debounce=function(a,c){var g;return function(){var d=this,b=arguments;clearTimeout(g);g=setTimeout(function(){g=null;a.apply(d,b)},c)}};c.once=function(a){var c=!1,g;return function(){if(c)return g;c=!0;return g=a.apply(this,arguments)}};c.wrap=function(a,c){return function(){var g=[a].concat(d.call(arguments,0));return c.apply(this,g)}};c.compose=function(){var a=arguments;return function(){for(var c=arguments,g=a.length-1;0<=g;g--)c=[a[g].apply(this,c)];return c[0]}};c.after=function(a,
c){return 0>=a?c():function(){if(1>--a)return c.apply(this,arguments)}};c.keys=a||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],g;for(g in a)u.call(a,g)&&(c[c.length]=g);return c};c.values=function(a){return c.map(a,c.identity)};c.functions=c.methods=function(a){var g=[],d;for(d in a)c.isFunction(a[d])&&g.push(d);return g.sort()};c.extend=function(a){t(d.call(arguments,1),function(c){for(var g in c)void 0!==c[g]&&(a[g]=c[g])});return a};c.defaults=function(a){t(d.call(arguments,
1),function(c){for(var g in c)null==a[g]&&(a[g]=c[g])});return a};c.clone=function(a){return!c.isObject(a)?a:c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,c){c(a);return a};c.isEqual=function(a,c){return h(a,c,[])};c.isEmpty=function(a){if(c.isArray(a)||c.isString(a))return 0===a.length;for(var g in a)if(u.call(a,g))return!1;return!0};c.isElement=function(a){return!!(a&&1==a.nodeType)};c.isArray=f||function(a){return"[object Array]"==m.call(a)};c.isObject=function(a){return a===Object(a)};
c.isArguments=function(a){return"[object Arguments]"==m.call(a)};if(!c.isArguments(arguments))c.isArguments=function(a){return!(!a||!u.call(a,"callee"))};c.isFunction=function(a){return"[object Function]"==m.call(a)};c.isString=function(a){return"[object String]"==m.call(a)};c.isNumber=function(a){return"[object Number]"==m.call(a)};c.isNaN=function(a){return a!==a};c.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==m.call(a)};c.isDate=function(a){return"[object Date]"==m.call(a)};
c.isRegExp=function(a){return"[object RegExp]"==m.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.noConflict=function(){b._=e;return this};c.identity=function(a){return a};c.times=function(a,c,g){for(var d=0;d<a;d++)c.call(g,d)};c.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};c.mixin=function(a){t(c.functions(a),function(g){E(g,c[g]=
a[g])})};var F=0;c.uniqueId=function(a){var c=F++;return a?a+c:c};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/.^/;c.template=function(a,g){var d=c.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||A,function(a,c){return"',_.escape("+c.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate||A,function(a,c){return"',"+c.replace(/\\'/g,
"'")+",'"}).replace(d.evaluate||A,function(a,c){return"');"+c.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ").replace(/\\\\/g,"\\")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",b=new Function("obj","_",d);return g?b(g,c):function(a){return b.call(this,a,c)}};c.chain=function(a){return c(a).chain()};var z=function(a){this._wrapped=a};c.prototype=z.prototype;var B=function(a,g){return g?c(a).chain():a},E=function(a,g){z.prototype[a]=function(){var a=
d.call(arguments);j.call(a,this._wrapped);return B(g.apply(c,a),this._chain)}};c.mixin(c);t("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var c=k[a];z.prototype[a]=function(){var g=this._wrapped;c.apply(g,arguments);var d=g.length;("shift"==a||"splice"==a)&&0===d&&delete g[0];return B(g,this._chain)}});t(["concat","join","slice"],function(a){var c=k[a];z.prototype[a]=function(){return B(c.apply(this._wrapped,arguments),this._chain)}});z.prototype.chain=function(){this._chain=
!0;return this};z.prototype.value=function(){return this._wrapped}}).call(this);
(function(h){var b=String.prototype.trim,e=function(d,b){for(var e=[];0<b;e[--b]=d);return e.join("")},i=function(d){return function(){for(var b=Array.prototype.slice.call(arguments),e=0;e<b.length;e++)b[e]=null==b[e]?"":""+b[e];return d.apply(null,b)}},k=function(){function d(d){return Object.prototype.toString.call(d).slice(8,-1).toLowerCase()}var b=function(){b.cache.hasOwnProperty(arguments[0])||(b.cache[arguments[0]]=b.parse(arguments[0]));return b.format.call(null,b.cache[arguments[0]],arguments)};
b.format=function(b,j){var i=1,h=b.length,f="",q=[],r,p,l,o;for(r=0;r<h;r++)if(f=d(b[r]),"string"===f)q.push(b[r]);else if("array"===f){l=b[r];if(l[2]){f=j[i];for(p=0;p<l[2].length;p++){if(!f.hasOwnProperty(l[2][p]))throw k('[_.sprintf] property "%s" does not exist',l[2][p]);f=f[l[2][p]]}}else f=l[1]?j[l[1]]:j[i++];if(/[^s]/.test(l[8])&&"number"!=d(f))throw k("[_.sprintf] expecting number but found %s",d(f));switch(l[8]){case "b":f=f.toString(2);break;case "c":f=String.fromCharCode(f);break;case "d":f=
parseInt(f,10);break;case "e":f=l[7]?f.toExponential(l[7]):f.toExponential();break;case "f":f=l[7]?parseFloat(f).toFixed(l[7]):parseFloat(f);break;case "o":f=f.toString(8);break;case "s":f=(f=""+f)&&l[7]?f.substring(0,l[7]):f;break;case "u":f=Math.abs(f);break;case "x":f=f.toString(16);break;case "X":f=f.toString(16).toUpperCase()}f=/[def]/.test(l[8])&&l[3]&&0<=f?"+"+f:f;p=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ";o=l[6]-(""+f).length;p=l[6]?e(p,o):"";q.push(l[5]?f+p:p+f)}return q.join("")};b.cache={};
b.parse=function(d){for(var b=[],e=[],j=0;d;){if(null!==(b=/^[^\x25]+/.exec(d)))e.push(b[0]);else if(null!==(b=/^\x25{2}/.exec(d)))e.push("%");else if(null!==(b=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(d))){if(b[2]){var j=j|1,f=[],i=b[2],h=[];if(null!==(h=/^([a-z_][a-z_\d]*)/i.exec(i)))for(f.push(h[1]);""!==(i=i.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(i)))f.push(h[1]);else if(null!==(h=/^\[(\d+)\]/.exec(i)))f.push(h[1]);
else throw"[_.sprintf] huh?";else throw"[_.sprintf] huh?";b[2]=f}else j|=2;if(3===j)throw"[_.sprintf] mixing positional and named placeholders is not (yet) supported";e.push(b)}else throw"[_.sprintf] huh?";d=d.substring(b[0].length)}return e};return b}(),f={VERSION:"1.2.0",isBlank:i(function(d){return/^\s*$/.test(d)}),stripTags:i(function(d){return d.replace(/<\/?[^>]+>/ig,"")}),capitalize:i(function(d){return d.charAt(0).toUpperCase()+d.substring(1).toLowerCase()}),chop:i(function(d,b){for(var b=
1*b||d.length,e=[],f=0;f<d.length;)e.push(d.slice(f,f+b)),f+=b;return e}),clean:i(function(d){return f.strip(d.replace(/\s+/g," "))}),count:i(function(d,b){for(var e=0,f,i=0;i<d.length;)f=d.indexOf(b,i),0<=f&&e++,i=i+(0<=f?f:0)+b.length;return e}),chars:i(function(d){return d.split("")}),escapeHTML:i(function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:i(function(d){return d.replace(/&lt;/g,"<").replace(/&gt;/g,
">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:i(function(d){return d.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}),insert:i(function(d,b,e){d=d.split("");d.splice(1*b||0,0,e);return d.join("")}),include:i(function(d,b){return-1!==d.indexOf(b)}),join:i(function(d){var b=Array.prototype.slice.call(arguments);return b.join(b.shift())}),lines:i(function(d){return d.split("\n")}),reverse:i(function(d){return Array.prototype.reverse.apply((""+d).split("")).join("")}),
splice:i(function(d,b,e,f){d=d.split("");d.splice(1*b||0,1*e||0,f);return d.join("")}),startsWith:i(function(d,b){return d.length>=b.length&&d.substring(0,b.length)===b}),endsWith:i(function(d,b){return d.length>=b.length&&d.substring(d.length-b.length)===b}),succ:i(function(d){var b=d.split("");b.splice(d.length-1,1,String.fromCharCode(d.charCodeAt(d.length-1)+1));return b.join("")}),titleize:i(function(d){for(var d=d.split(" "),b,e=0;e<d.length;e++)b=d[e].split(""),"undefined"!==typeof b[0]&&(b[0]=
b[0].toUpperCase()),e+1===d.length?d[e]=b.join(""):d[e]=b.join("")+" ";return d.join("")}),camelize:i(function(d){return f.trim(d).replace(/(\-|_|\s)+(.)?/g,function(d,b,e){return e?e.toUpperCase():""})}),underscored:function(d){return f.trim(d).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(d){return f.trim(d).replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/^([A-Z]+)/,"-$1").replace(/\_|\s+/g,"-").toLowerCase()},humanize:function(d){return f.capitalize(this.underscored(d).replace(/_id$/,
"").replace(/_/g," "))},trim:i(function(d,e){if(!e&&b)return b.call(d);e=e?f.escapeRegExp(e):"\\s";return d.replace(RegExp("^["+e+"]+|["+e+"]+$","g"),"")}),ltrim:i(function(d,b){b=b?f.escapeRegExp(b):"\\s";return d.replace(RegExp("^["+b+"]+","g"),"")}),rtrim:i(function(d,b){b=b?f.escapeRegExp(b):"\\s";return d.replace(RegExp("["+b+"]+$","g"),"")}),truncate:i(function(d,b,e){b=1*b||0;return d.length>b?d.slice(0,b)+(e||"..."):d}),prune:i(function(d,b,e){var e=e||"...",b=1*b||0,i="",i=0===d.substring(b-
1,b+1).search(/^\w\w$/)?f.rtrim(d.slice(0,b).replace(/([\W][\w]*)$/,"")):f.rtrim(d.slice(0,b)),i=i.replace(/\W+$/,"");return i.length+e.length>d.length?d:i+e}),words:function(d,b){return(""+d).split(b||" ")},pad:i(function(d,b,f,i){var h="",h=0,b=1*b||0;f?1<f.length&&(f=f.charAt(0)):f=" ";switch(i){case "right":h=b-d.length;h=e(f,h);d+=h;break;case "both":h=b-d.length;h={left:e(f,Math.ceil(h/2)),right:e(f,Math.floor(h/2))};d=h.left+d+h.right;break;default:h=b-d.length,h=e(f,h),d=h+d}return d}),lpad:function(b,
e,i){return f.pad(b,e,i)},rpad:function(b,e,i){return f.pad(b,e,i,"right")},lrpad:function(b,e,i){return f.pad(b,e,i,"both")},sprintf:k,vsprintf:function(b,e){e.unshift(b);return k.apply(null,e)},toNumber:function(b,e){var f;f=1*(1*b||0).toFixed(1*e||0)||0;return!(0===f&&"0"!==b&&0!==b)?f:Number.NaN},strRight:i(function(b,e){var f=!e?-1:b.indexOf(e);return-1!=f?b.slice(f+e.length,b.length):b}),strRightBack:i(function(b,e){var f=!e?-1:b.lastIndexOf(e);return-1!=f?b.slice(f+e.length,b.length):b}),strLeft:i(function(b,
e){var f=!e?-1:b.indexOf(e);return-1!=f?b.slice(0,f):b}),strLeftBack:i(function(b,e){var f=b.lastIndexOf(e);return-1!=f?b.slice(0,f):b}),exports:function(){var b={},e;for(e in this)if(this.hasOwnProperty(e)&&!("include"==e||"contains"==e||"reverse"==e))b[e]=this[e];return b}};f.strip=f.trim;f.lstrip=f.ltrim;f.rstrip=f.rtrim;f.center=f.lrpad;f.ljust=f.lpad;f.rjust=f.rpad;f.contains=f.include;if("undefined"!==typeof exports){if("undefined"!==typeof module&&module.exports)module.exports=f;exports._s=
f}else"undefined"!==typeof h._?(h._.string=f,h._.str=h._.string):h._={string:f,str:f}})(this||window);(function(){var h=this,b=h.Backbone,e;e="undefined"!==typeof exports?exports:h.Backbone={};e.VERSION="0.5.3";var i=h._;if(!i&&"undefined"!==typeof require)i=require("underscore")._;var k=h.jQuery||h.Zepto;e.noConflict=function(){h.Backbone=b;return this};e.emulateHTTP=!1;e.emulateJSON=!1;e.Events={bind:function(a,g,c){var b=this._callbacks||(this._callbacks={});(b[a]||(b[a]=[])).push([g,c]);return this},unbind:function(a,g){var c;if(a){if(c=this._callbacks)if(g){c=c[a];if(!c)return this;for(var b=
0,d=c.length;b<d;b++)if(c[b]&&g===c[b][0]){c[b]=null;break}}else c[a]=[]}else this._callbacks={};return this},trigger:function(a){var b,c,d,e,f=2;if(!(c=this._callbacks))return this;for(;f--;)if(b=f?a:"all",b=c[b])for(var i=0,h=b.length;i<h;i++)(d=b[i])?(e=f?Array.prototype.slice.call(arguments,1):arguments,d[0].apply(d[1]||this,e)):(b.splice(i,1),i--,h--);return this}};e.Model=function(a,b){var c;a||(a={});if(c=this.defaults)i.isFunction(c)&&(c=c.call(this)),a=i.extend({},c,a);this.attributes={};
this._escapedAttributes={};this.cid=i.uniqueId("c");this.set(a,{silent:!0});this._changed=!1;this._previousAttributes=i.clone(this.attributes);if(b&&b.collection)this.collection=b.collection;this.initialize(a,b)};i.extend(e.Model.prototype,e.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.attributes[a];
return this._escapedAttributes[a]=(null==b?"":""+b).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(a){return null!=this.attributes[a]},set:function(a,b){b||(b={});if(!a)return this;if(a.attributes)a=a.attributes;var c=this.attributes,d=this._escapedAttributes;if(!b.silent&&this.validate&&!this._performValidation(a,b))return!1;if(this.idAttribute in a)this.id=a[this.idAttribute];
var e=this._changing;this._changing=!0;for(var f in a){var h=a[f];if(!i.isEqual(c[f],h))c[f]=h,delete d[f],this._changed=!0,b.silent||this.trigger("change:"+f,this,h,b)}!e&&!b.silent&&this._changed&&this.change(b);this._changing=!1;return this},unset:function(a,b){if(!(a in this.attributes))return this;b||(b={});var c={};c[a]=void 0;if(!b.silent&&this.validate&&!this._performValidation(c,b))return!1;delete this.attributes[a];delete this._escapedAttributes[a];a==this.idAttribute&&delete this.id;this._changed=
!0;b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b));return this},clear:function(a){a||(a={});var b,c=this.attributes,d={};for(b in c)d[b]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={};this._escapedAttributes={};this._changed=!0;if(!a.silent){for(b in c)this.trigger("change:"+b,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&
c(b,d)};a.error=y(a.error,b,a);return(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b){b||(b={});if(a&&!this.set(a,b))return!1;var c=this,d=b.success;b.success=function(a,e,f){if(!c.set(c.parse(a,f),b))return!1;d&&d(c,a,f)};b.error=y(b.error,c,b);var f=this.isNew()?"create":"update";return(this.sync||e.sync).call(this,f,this,b)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var b=this,c=a.success;a.success=function(d){b.trigger("destroy",
b,b.collection,a);c&&c(b,d)};a.error=y(a.error,b,a);return(this.sync||e.sync).call(this,"delete",this,a)},url:function(){var a=l(this.collection)||this.urlRoot||o();return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this)},isNew:function(){return null==this.id},change:function(a){this.trigger("change",this,a);this._previousAttributes=i.clone(this.attributes);this._changed=!1},hasChanged:function(a){return a?
this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var b=this._previousAttributes,c=!1,d;for(d in a)i.isEqual(b[d],a[d])||(c=c||{},c[d]=a[d]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return i.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),
!1):!0}});e.Collection=function(a,b){b||(b={});if(b.comparator)this.comparator=b.comparator;i.bindAll(this,"_onModelEvent","_removeReference");this._reset();a&&this.reset(a,{silent:!0});this.initialize.apply(this,arguments)};i.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(i.isArray(a))for(var c=0,d=a.length;c<d;c++)this._add(a[c],b);else this._add(a,b);return this},remove:function(a,
b){if(i.isArray(a))for(var c=0,d=a.length;c<d;c++)this._remove(a[c],b);else this._remove(a,b);return this},get:function(a){return null==a?null:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return i.map(this.models,
function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});this.each(this._removeReference);this._reset();this.add(a,{silent:!0});b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a||(a={});var b=this,c=a.success;a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=y(a.error,b,a);return(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={});a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;b.success=
function(a,e,f){c.add(a,b);d&&d(a,e,f)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return i(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model){if(!a.collection)a.collection=this}else{var c=a,a=new this.model(c,{collection:this});a.validate&&!a._performValidation(c,b)&&(a=!1)}return a},_add:function(a,b){b||(b={});a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);
if(c)throw Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a;this._byCid[a.cid]=a;this.models.splice(null!=b.at?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length,0,a);a.bind("all",this._onModelEvent);this.length++;b.silent||a.trigger("add",a,this,b);return a},_remove:function(a,b){b||(b={});a=this.getByCid(a)||this.get(a);if(!a)return null;delete this._byId[a.id];delete this._byCid[a.cid];this.models.splice(this.indexOf(a),1);this.length--;b.silent||a.trigger("remove",
a,this,b);this._removeReference(a);return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});i.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,rest,last,without,indexOf,lastIndexOf,isEmpty,groupBy".split(","),
function(a){e.Collection.prototype[a]=function(){return i[a].apply(i,[this.models].concat(i.toArray(arguments)))}});e.Router=function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var f=/:([\w\d]+)/g,d=/\*([\w\d]+)/g,j=/[-[\]{}()+?.,\\^$|#\s]/g;i.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){e.history||(e.history=new e.History);i.isRegExp(a)||(a=this._routeToRegExp(a));e.history.route(a,i.bind(function(d){d=
this._extractParameters(a,d);c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d))},this))},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(j,"\\$&").replace(f,"([^/]*)").replace(d,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});
e.History=function(){this.handlers=[];i.bindAll(this,"checkUrl")};var m=/^#*/,u=/msie [\w.]+/,w=!1;i.extend(e.History.prototype,{interval:50,getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c);0==a.indexOf(this.options.root)&&(a=a.substr(this.options.root.length))}else a=window.location.hash;return decodeURIComponent(a.replace(m,""))},start:function(a){if(w)throw Error("Backbone.history has already been started");this.options=
i.extend({},{root:"/"},this.options,a);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=u.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=k('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?k(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!b?k(window).bind("hashchange",
this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=a;w=!0;a=window.location;b=a.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;if(this._wantsPushState&&this._hasPushState&&b&&a.hash)this.fragment=a.hash.replace(m,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment);if(!this.options.silent)return this.loadUrl()},
route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return i.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,
b){var c=(a||"").replace(m,"");if(!(this.fragment==c||this.fragment==decodeURIComponent(c))){if(this._hasPushState){var d=window.location;0!=c.indexOf(this.options.root)&&(c=this.options.root+c);this.fragment=c;window.history.pushState({},document.title,d.protocol+"//"+d.host+c)}else if(window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash))this.iframe.document.open().close(),this.iframe.location.hash=c;b&&this.loadUrl(a)}}});e.View=function(a){this.cid=i.uniqueId("view");
this._configure(a||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var x=/^(\S+)\s*(.*)$/,v="model,collection,el,id,attributes,className,tagName".split(",");i.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return k(a,this.el)},initialize:function(){},render:function(){return this},remove:function(){k(this.el).remove();return this},make:function(a,b,c){a=document.createElement(a);b&&k(a).attr(b);c&&k(a).html(c);return a},delegateEvents:function(a){if(a||
(a=this.events)){i.isFunction(a)&&(a=a.call(this));k(this.el).unbind(".delegateEvents"+this.cid);for(var b in a){var c=this[a[b]];if(!c)throw Error('Event "'+a[b]+'" does not exist');var d=b.match(x),e=d[1],d=d[2],c=i.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?k(this.el).bind(e,c):k(this.el).delegate(d,e,c)}}},_configure:function(a){this.options&&(a=i.extend({},this.options,a));for(var b=0,c=v.length;b<c;b++){var d=v[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el){if(i.isString(this.el))this.el=
k(this.el).get(0)}else{var a=this.attributes||{};if(this.id)a.id=this.id;if(this.className)a["class"]=this.className;this.el=this.make(this.tagName,a)}}});e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=function(a,b){var c=p(this,a,b);c.extend=this.extend;return c};var q={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=q[a],c=i.extend({type:d,dataType:"json"},c);if(!c.url)c.url=l(b)||o();if(!c.data&&b&&("create"==a||"update"==a))c.contentType=
"application/json",c.data=JSON.stringify(b.toJSON());if(e.emulateJSON)c.contentType="application/x-www-form-urlencoded",c.data=c.data?{model:c.data}:{};if(e.emulateHTTP&&("PUT"===d||"DELETE"===d)){if(e.emulateJSON)c.data._method=d;c.type="POST";c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}}if("GET"!==c.type&&!e.emulateJSON)c.processData=!1;return k.ajax(c)};var r=function(){},p=function(a,b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){return a.apply(this,
arguments)};i.extend(d,a);r.prototype=a.prototype;d.prototype=new r;b&&i.extend(d.prototype,b);c&&i.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},l=function(a){return!a||!a.url?null:i.isFunction(a.url)?a.url():a.url},o=function(){throw Error('A "url" property or function must be specified');},y=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}}}).call(this);function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}window.Store=function(h){this.name=h;this.records=(h=localStorage.getItem(this.name))&&h.split(",")||[]};
_.extend(Store.prototype,{save:function(){localStorage.setItem(this.name,this.records.join(","))},create:function(h){if(!h.id)h.id=h.attributes.id=guid();localStorage.setItem(this.name+"-"+h.id,JSON.stringify(h));this.records.push(h.id.toString());this.save();return h},update:function(h){localStorage.setItem(this.name+"-"+h.id,JSON.stringify(h));_.include(this.records,h.id.toString())||this.records.push(h.id.toString());this.save();return h},find:function(h){return JSON.parse(localStorage.getItem(this.name+
"-"+h.id))},findAll:function(){return _.map(this.records,function(h){return JSON.parse(localStorage.getItem(this.name+"-"+h))},this)},destroy:function(h){localStorage.removeItem(this.name+"-"+h.id);this.records=_.reject(this.records,function(b){return b==h.id.toString()});this.save();return h}});Backbone.remoteSync=Backbone.sync;
Backbone.sync=function(h,b,e,i){"function"==typeof e&&(e={success:e,error:i});var k,f=b.localStorage||b.collection&&b.collection.localStorage;if(!f)return Backbone.remoteSync(h,b,e,i);switch(h){case "read":k=b.id?f.find(b):f.findAll();break;case "create":k=f.create(b);break;case "update":k=f.update(b);break;case "delete":k=f.destroy(b)}k?e.success(k):e.error("Record not found")};window.Modernizr=function(h,b,e){function i(b,d){var e=b.charAt(0).toUpperCase()+b.substr(1),e=(b+" "+u.join(e+" ")+e).split(" ");return k(e,d)}function k(b,d){for(var f in b)if(m[b[f]]!==e)return"pfx"==d?b[f]:!0;return!1}var f={},d=b.documentElement;b.head||b.getElementsByTagName("head");var j=b.createElement("modernizr"),m=j.style,h=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),u="Webkit Moz O ms Khtml".split(" "),j={},w=[],x=function(e,f,i,a){var g,c,h=b.createElement("div");if(parseInt(i,10))for(;i--;)c=
b.createElement("div"),c.id=a?a[i]:"modernizr"+(i+1),h.appendChild(c);g=["&shy;<style>",e,"</style>"].join("");h.id="modernizr";h.innerHTML+=g;d.appendChild(h);e=f(h,e);h.parentNode.removeChild(h);return!!e},v,q={}.hasOwnProperty,r;typeof q!==e&&typeof q.call!==e?r=function(b,d){return q.call(b,d)}:r=function(b,d){return d in b&&typeof b.constructor.prototype[d]===e};(function(b,d){var e=b.join(""),a=d.length;x(e,function(b){for(var b=b.childNodes,c={};a--;)c[b[a].id]=b[a];f.csstransforms3d=9===c.csstransforms3d.offsetLeft},
a,d)})([,["@media (",h.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute}}"].join("")],[,"csstransforms3d"]);j.csstransforms=function(){return!!k(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])};j.csstransforms3d=function(){var b=!!k(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);b&&"webkitPerspective"in d.style&&(b=f.csstransforms3d);return b};j.csstransitions=function(){return i("transitionProperty")};
for(var p in j)r(j,p)&&(v=p.toLowerCase(),f[v]=j[p](),w.push((f[v]?"":"no-")+v));m.cssText="";j=null;f._version="2.0.6";f._prefixes=h;f._domPrefixes=u;f.testProp=function(b){return k([b])};f.testAllProps=i;f.testStyles=x;return f}(this,this.document);CFW={domain:"http://cfwhiteboard.com"};
jQuery(function(h){h(document.embeds).each(function(){var b=h(this);setTimeout(function(){var e=!1,i=b.attr("wmode");"opaque"!=i&&"transparent"!=i&&(b.attr("wmode","opaque"),e=!0);var k=b.closest("object"),i=k.children("param[name=wmode]").val();"opaque"!=i&&"transparent"!=i&&(k.prepend(h('<param name="wmode" value="opaque" />')),e=!0);e&&(k=k.length?k:b,k.after(h('<span class="cfw-placeholder" />')),k.next().replaceWith(k))},h.browser.msie?300:0)});h("iframe").each(function(){/youtube/.test(this.src)&&!/wmode=transparent/.test(this.src)&&
!/wmode=opaque/.test(this.src)&&(this.src+=(0<=this.src.substring(this.src.lastIndexOf&&this.src.lastIndexOf("/")).indexOf("?")?"&":"?")+"wmode=opaque")})});
jQuery(function(h){if(!Modernizr.csstransitions)Modernizr.csstransforms=!1,Modernizr.csstransforms3d=!1;if(/AppleWebKit/i.test(navigator.userAgent)&&!/Mobile/i.test(navigator.userAgent))Modernizr.csstransforms3d=!1;if(h.browser.msie&&window.XDomainRequest)jQuery.ajaxSetup({xhr:function(){try{var b=new XDomainRequest;b.timeout=5E3;b.getAllResponseHeaders=function(){return""};var e=function(){var e=new XDomainRequest;e.timeout=b.timeout;e.onload=b.onload;e.onerror=b.onerror;e.ontimeout=b.ontimeout;
e.open(b.openArgs[0],b.openArgs[1]);e.send(b.sendArgs[0])};b.onload=function(){b.onload=b.onerror=b.ontimeout=jQuery.noop;b.status=200;b.statusText="OK";b.readyState=4;b.onreadystatechange&&b.onreadystatechange()};b.onerror=function(){e()};b.ontimeout=function(){e()};b.originalOpen=b.open;b.open=function(e,f){"PUT"===e?(f+="/revise",e="POST"):"DELETE"===e&&(f+="/annihilate",e="POST");b.openArgs=[e,f];b.originalOpen(e,f)};b.originalSend=b.send;b.send=function(e){b.sendArgs=[e];setTimeout(function(){b.originalSend(e)},
0)};return b}catch(i){return jQuery.ajaxSettings.xhr()}}}),jQuery.support.cors=!0;CFW.User=Backbone.Model.extend({defaults:function(){return{email:"",known_as:"",count:0,highlightColor:CFW.User.prototype.randomColor()}},randomColor:function(){return[[255,75,105],[255,105,75],[75,105,255],[105,75,255],[75,255,105],[105,255,75],[123,6,226],[226,6,123],[6,226,123],[6,123,226]][Math.floor(10*Math.random()+0)]}});CFW.UserList=Backbone.Collection.extend({model:CFW.User,initialize:function(){this.localStorage=
new Store("cfw-users");return this},comparator:function(b){return-b.get("count")}});CFW.users=new CFW.UserList;CFW.users.fetch();CFW.Entry=Backbone.Model.extend({defaults:{athlete_id:"",known_as:"",email:"",result:"",rx:!1,mods:"",notes:""},emailRegex:/^\S+@\S+\.\S+$/,validate:function(b){var e=[];!(b.athlete_id||this.attributes&&this.get("athlete_id"))&&!this.emailRegex.test(b.email)&&e.push("email");(!b.result||!b.result.length)&&e.push("result");if(e.length)return e}});CFW.EntryList=Backbone.Collection.extend({model:CFW.Entry,
url:function(){return CFW.domain+"/affiliates/"+this.affiliateId+"/wods/"+this.postId+"/posts"},initialize:function(b,e){this.affiliateId=e.affiliateId;this.postId=e.postId;return this},comparator:function(b){return b.get("known_as").toLowerCase()}});CFW.EntryItemView=Backbone.View.extend({tagName:"tr",template:_.template('            <td class="cfw-known-as"><%- known_as %></td>            <td class="cfw-result"><%- result %></td>            <td class="cfw-mods">                <div>                    <%= rx ? "<strong>Rx</strong> " : "" %><%- mods %><span class="cfw-more <%= notes ? "cfw-notes-hint" : "" %>">&bull;&bull;&bull;</span>                </div>            </td>        '),
events:{click:"showDetail"},initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.remove,this);this.model.bind("show",this.lookSelected,this);this.model.bind("unshow",this.unlookSelected,this);this.render()},render:function(){h(this.el).html(this.template(this.model.toJSON()));return this},lookSelected:function(){h(this.el).addClass("cfw-selected")},unlookSelected:function(){h(this.el).removeClass("cfw-selected")},addHighlight:function(b){h(this.el).addClass("cfw-highlighted").css({backgroundColor:"rgba("+
b.join(",")+",.2)",borderColor:"rgba("+b.join(",")+",.2)"})},removeHighlight:function(){h(this.el).removeClass("cfw-highlighted").css({backgroundColor:"transparent",borderColor:"#888"})},showDetail:function(){this.model.trigger("show",this.model)}});CFW.WhiteboardPage=Backbone.View.extend({tagName:"div",className:"cfw-page",show:function(){h(this.el).addClass("active").trigger("cfwshow")},hide:function(){h(this.el).removeClass("active").trigger("cfwhide")}});CFW.EntryListView=CFW.WhiteboardPage.extend({template:_.template('            <table cellspacing="0">                <thead>                    <tr>                        <th class="cfw-known-as">Name</th>                        <th class="cfw-result">Entry</th>                        <th class="cfw-mods">Modifications</th>                    </tr>                </thead>            </table>            <div class="cfw-scrollable">                <table cellspacing="0">                    <tbody>                    </tbody>                </table>            </div>        '),
events:{cfwshow:"showScrollbar",cfwhide:"hideScrollbar"},initialize:function(b){this.entries=b.entries;this.entryItemViews=[];this.entries.bind("add",this.addAll,this);this.entries.bind("change:known_as",this.addAll,this);this.entries.bind("remove",this.addAll,this);this.entries.bind("reset",this.addAll,this);CFW.users.bind("reset",this.updateHighlightedUsers,this);CFW.users.bind("change",this.updateHighlightedUsers,this);CFW.users.bind("add",this.addHighlightedUser,this);CFW.users.bind("remove",
this.removeHighlightedUser,this);h(this.el).one("cfwshow",_.bind(this.initScrollbar,this));return this.render()},render:function(){h(this.el).html(this.template());return this},addOne:function(b){b=new CFW.EntryItemView({model:b});this.entryItemViews.push(b);this.$("tbody").append(b.el)},addAll:function(){_.each(this.entryItemViews,function(b,e,i){b.remove();delete i[e]});this.$("tbody").empty();this.entries.length?this.entries.each(this.addOne,this):this.$("tbody").append(h('                    <tr class="cfw-no-entries">                        <td colspan="100">No one has added an entry yet.<br /><a class="cfw-new-entry">Add yours now!<a></td>                    </tr>                '));
this.updateHighlightedUsers()},initScrollbar:function(){},showScrollbar:function(){},hideScrollbar:function(){},updateHighlightedUsers:function(){this.entries.each(function(b){b.trigger("removeHighlight")});CFW.users.each(this.addHighlightedUser,this)},addHighlightedUser:function(b){_.each(this.entries.select(function(e){return e.get("email").toLowerCase()==b.get("email").toLowerCase()}),function(e){e.trigger("addHighlight",b.get("highlightColor"))})},removeHighlightedUser:function(b){_.each(this.entries.select(function(e){return e.get("email").toLowerCase()==
b.get("email").toLowerCase()}),function(b){b.trigger("removeHighlight")})}});CFW.EntryDetailView=CFW.WhiteboardPage.extend({template:_.template('            <div class="cfw-entry-detail">                <a class="cfw-back">back</a><a class="cfw-edit">edit</a>                <dl>                    <dt>Name</dt>                    <dd class="cfw-known-as"><%- known_as %></dd>                    <dt>Entry</dt>                    <dd class="cfw-result"><%- result %></dd>                    <dt>Modifications</dt>                    <dd class="cfw-mods"><%= rx ? "<strong>Rx</strong> " : "" %><%- mods %><%= !rx && !mods ? "(no data)" : "" %></dd>                    <dt>Notes</dt>                    <dd class="cfw-notes"><%- notes || "(no data)" %></dd>                </dl>            </div>        '),
events:{"click a.cfw-edit":"edit","click a.cfw-back":"back",cfwhide:"cleanup"},initialize:function(){this.model.bind("change",this.render,this);this.model.bind("destroy",this.hide,this);return this.render()},render:function(){h(this.el).addClass("scrollable").html(this.template(this.model.toJSON()));return this},edit:function(){this.model.trigger("edit",this.model)},back:function(){h(this.el).trigger("hideEntryDetails")},cleanup:function(){var b=this;setTimeout(function(){b.model.trigger("unshow",
b.model);b.remove()},Modernizr.csstransitions?300:0)}});CFW.EntryFormView=Backbone.View.extend({tagName:"form",className:"cfw-scrollable",template:_.template('            <h2><%= new_record ? "Add Your Entry" : "Edit Your Entry" %></h2>            <label for="cfw-email">Email Address</label>            <input type="email" id="cfw-email" name="email" placeholder="name@example.com" <%= new_record ? "" : \'value="&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;" disabled="disabled"\' %> />            <div class="cfw-nobr">                <label for="cfw-known-as" class="cfw-half">Name</label><label for="cfw-result" class="cfw-half">Entry</label>            </div>            <div class="cfw-nobr">                <input type="text" id="cfw-known-as" class="cfw-half" name="known_as" placeholder="Guest" value="<%- known_as %>"                /><input type="text" id="cfw-result" class="cfw-half" name="result" placeholder="How\'d you do?" value="<%- result %>" />            </div>            <div class="cfw-nobr">                <label for="cfw-rx" class="cfw-minority">Rx</label><label for="cfw-mods" class="cfw-majority">Modifications</label>            </div>            <div class="cfw-nobr">                <input type="checkbox" id="cfw-rx" class="cfw-minority" name="rx" <%= rx ? \'checked="checked"\' : "" %>                /><span>or</span><input type="text" id="cfw-mods" class="cfw-majority" name="mods" placeholder="How did you scale?" value="<%- mods %>" />            </div>            <div class="cfw-notes <%= notes ? "cfw-open cfw-opaque" : "" %>">                <label for="cfw-notes">Notes</label>                <textarea rows="3" id="cfw-notes" name="notes" placeholder="Notes or Tips for next time?"><%- notes %></textarea>            </div>            <div class="cfw-footer">                <a class="cfw-add-notes <%= notes ? "cfw-hidden" : "" %>"><strong>+</strong> add notes</a>                <input type="submit" value="<%= new_record ? "Submit" : "Save" %>" />                <input type="reset" value="Cancel" />            </div>        '),
events:{'keyup input[name="email"]':"guessName",'change input[name="email"]':"guessName",'blur input[name="known_as"]':"guessName","click .cfw-add-notes":"showNotesFields",submit:"save",'click input[type="reset"]':"remove"},initialize:function(b){this.entries=b.entries;return this.render()},render:function(){h(this.el).attr("action","javascript://").html(this.template(_.extend({new_record:!this.model},(this.model||new CFW.Entry).toJSON())));return this},guessName:function(){var b=this.$('input[name="email"]'),
e=this.$('input[name="known_as"]');if(!(e.val().length&&this.lastGuess&&e.val()!=this.lastGuess||e.val().length&&!this.lastGuess)){var i=CFW.users.find(function(e){return e.get("email").toLowerCase()==b.val().toLowerCase()});if(i)e.val(this.lastGuess=i.get("known_as"));else{var i=b.val(),h=i.indexOf("@");if(!_.capitalize)_.capitalize=function(b){return b.substring(0,1).toUpperCase()+b.substring(1)};e.val(this.lastGuess=-1==h?_.capitalize(i):_.capitalize(i.substring(0,h)))}}},showNotesFields:function(){var b=
this.$(".cfw-notes").addClass("cfw-open"),e=this.$(".cfw-add-notes").addClass("cfw-transparent");setTimeout(function(){b.addClass("cfw-opaque");e.addClass("cfw-hidden")},Modernizr.csstransitions?200:0)},save:function(b){b.preventDefault();var b={result:this.$('input[name="result"]').val(),email:this.$('input[name="email"]').val(),known_as:this.$('input[name="known_as"]').val(),rx:this.$('input[name="rx"]').is(":checked"),mods:this.$('input[name="mods"]').val(),notes:this.$('textarea[name="notes"]').val()},
e=this;e.showLoading();e.$(".ajax-error-notice").remove();var i={success:function(){e.hideLoading();e.remove()},error:function(b,f){e.hideLoading();f&&f.length?e.showValidationErrors(f):e.$(".cfw-footer").after(h('<label class="cfw-invalid ajax-error-notice" style="text-align:center;line-height:1.2;">Oops! There was a problem connecting to the server.  Click <strong>'+e.$('input[type="submit"]').val()+"</strong> to try again or contact athlete support if the problem persists.</label>"))}};this.model?
this.model.save(b,i):this.entries.create(b,i)||this.showValidationErrors(CFW.Entry.prototype.validate(b))},show:function(){h(this.el).closest(".cfwhiteboard").find(".cfw-new-entry").attr("disabled",!0);Modernizr.csstransforms3d?h(this.el).addClass("cfw-translate3d"):Modernizr.csstransforms?h(this.el).addClass("cfw-translate"):h(this.el).animate({top:"0%",bottom:"0%"},300)},showLoading:function(){this.$('input[type="submit"]').addClass("loading")},hideLoading:function(){this.$('input[type="submit"]').removeClass("loading")},
showValidationErrors:function(b){var e=this;_.each(b,function(b){e.$('input[name="'+b+'"]').addClass("cfw-invalid").each(function(){h('label[for="'+h(this).attr("id")+'"]').addClass("cfw-invalid")}).one("keydown change",function(){h(this).removeClass("cfw-invalid");h('label[for="'+h(this).attr("id")+'"]').removeClass("cfw-invalid")})})},remove:function(){function b(){h(e.el).remove()}var e=this;Modernizr.csstransforms3d||Modernizr.csstransforms?(h(this.el).removeClass("cfw-translate3d cfw-translate"),
setTimeout(b,300)):h(this.el).animate({top:"100%",bottom:"-100%"},300,b);h(this.el).closest(".cfwhiteboard").find(".cfw-new-entry").removeAttr("disabled")}});CFW.WhiteboardView=Backbone.View.extend({template:_.template('            <h1>Whiteboard<span class="cfw-entry-count"></span></h1>            <div class="cfw-pane">                <a class="cfw-print cfw-admin-tool cfw-hidden" target="_blank">Print</a>                <div>                    <div class="cfw-window">                        <h2>Entries for Today&#039;s WOD</h2>                        <a class="cfw-new-entry">+</a>                        <div class="cfw-contents"></div>                        <div class="cfw-footer">                            <a href="http://cfwhiteboard.com" target="_blank">                                What Is This?                            </a><a href="mailto:athletesupport@cfwhiteboard.com">                                Email Athlete Support                            </a>                        </div>                    </div>                </div>            </div>            <div class="cfw-preload-images">                <span class="cfw-metal-tile-jpg"></span>                <span class="cfw-white-water-paper-jpg"></span>                <span class="cfw-loading-gif"></span>            </div>        '),
events:{"click h1":"toggleWhiteboard","click .cfw-new-entry:not([disabled])":"newEntry",hideEntryDetails:"hideEntry"},initialize:function(){var b=h(this.el);this.affiliateId=b.data("affiliateId")||b.data("affiliate-id");this.postId=b.data("postId")||b.data("post-id");if(!(-1<_.indexOf(_.pluck(CFW.instances,"postId"),this.postId)))this.entries=new CFW.EntryList([],{affiliateId:this.affiliateId,postId:this.postId}),this.entries.bind("add",this.updateEntryCount,this),this.entries.bind("remove",this.updateEntryCount,
this),this.entries.bind("reset",this.updateEntryCount,this),this.entries.bind("edit",this.editEntry,this),this.entries.bind("show",this.showEntry,this),this.entries.bind("add",this.updateUsers,this),this.entries.bind("change:known_as",this.updateUsers,this),this.render(),this.entries.fetch()},render:function(){var b=h(this.el).html(this.template());this.entryListView=new CFW.EntryListView({entries:this.entries});this.$(".cfw-contents").append(this.entryListView.el);this.entryListView.show();"admin"==
b.data("authorization")&&(this.$(".cfw-print").attr("href",this.entries.url()),this.$(".cfw-admin-tool").removeClass("cfw-hidden"));this.$(".cfw-scrollable").bind("scroll mousewheel wheel",function(b){b.stopPropagation()});return this},toggleWhiteboard:function(b){var e=h(this.el);e.is(".cfw-active")?(e.addClass("cfw-postactive").removeClass("cfw-active"),setTimeout(function(){e.removeClass("cfw-postactive")},Modernizr.csstransitions?300:0)):e.addClass("cfw-active").removeClass("cfw-postactive");
b.preventDefault()},newEntry:function(){var b=new CFW.EntryFormView({entries:this.entries});this.$(".cfw-contents").append(b.el);setTimeout(function(){b.show()},0)},editEntry:function(b){var e=new CFW.EntryFormView({entries:this.entries,model:b});this.$(".cfw-contents").append(e.el);setTimeout(function(){e.show()},0)},showEntry:function(b){this.detailView=new CFW.EntryDetailView({model:b});this.$(".cfw-contents").append(this.detailView.el);var e=this;setTimeout(function(){e.detailView.show();e.entryListView.hide()},
0)},hideEntry:function(){this.entryListView.show();this.detailView.hide()},updateEntryCount:function(){this.$(".cfw-entry-count").text("("+this.entries.length+")")},updateUsers:function(b){var e=CFW.users.find(function(e){return e.get("email").toLowerCase()==b.get("email").toLowerCase()});e?e.save({known_as:b.get("known_as"),count:e.get("count")+1}):e=CFW.users.create({email:b.get("email"),known_as:b.get("known_as"),count:1})}});CFW.instances=[];h(".cfwhiteboard").each(function(){var b=h(this),e=
b.closest("a");e.length&&e.before(b);if("undefined"!=typeof CFW_POSITION){e=b.closest(CFW_POSITION.parent).find(CFW_POSITION.target);if(e.length)switch(CFW_POSITION.insertion){case "append":e.append(b);break;case "before":e.before(b);break;case "after":e.after(b);break;default:e.prepend(b)}switch(CFW_POSITION.alignment){case "inline":b.addClass("position-inline");break;case "block":b.addClass("position-block");break;case "floatleft":b.addClass("position-floatleft")}CFW_POSITION.margin&&b.css({margin:CFW_POSITION.margin})}CFW.instances.push(new CFW.WhiteboardView({el:b}))})});
