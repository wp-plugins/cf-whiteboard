var JSON;JSON||(JSON={});
(function(){function d(a){return 10>a?"0"+a:a}function a(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var d=j[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function g(d,c){var h,o,j,v,r=f,s,n=c[d];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(d));"function"===typeof m&&(n=m.call(c,d,n));switch(typeof n){case "string":return a(n);case "number":return isFinite(n)?""+n:"null";case "boolean":case "null":return""+n;
case "object":if(!n)return"null";f+=l;s=[];if("[object Array]"===Object.prototype.toString.apply(n)){v=n.length;for(h=0;h<v;h+=1)s[h]=g(h,n)||"null";j=0===s.length?"[]":f?"[\n"+f+s.join(",\n"+f)+"\n"+r+"]":"["+s.join(",")+"]";f=r;return j}if(m&&"object"===typeof m){v=m.length;for(h=0;h<v;h+=1)"string"===typeof m[h]&&(o=m[h],(j=g(o,n))&&s.push(a(o)+(f?": ":":")+j))}else for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(j=g(o,n))&&s.push(a(o)+(f?": ":":")+j);j=0===s.length?"{}":f?"{\n"+f+s.join(",\n"+
f)+"\n"+r+"}":"{"+s.join(",")+"}";f=r;return j}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,l,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;if("function"!==typeof JSON.stringify)JSON.stringify=function(a,d,c){var h;l=f="";if("number"===typeof c)for(h=0;h<c;h+=1)l+=" ";else"string"===typeof c&&(l=c);if((m=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return g("",
{"":a})};if("function"!==typeof JSON.parse)JSON.parse=function(a,d){function f(a,c){var h,g,m=a[c];if(m&&"object"===typeof m)for(h in m)Object.prototype.hasOwnProperty.call(m,h)&&(g=f(m,h),void 0!==g?m[h]=g:delete m[h]);return d.call(a,c,m)}var c,a=""+a;h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof d?f({"":c},""):c;throw new SyntaxError("JSON.parse");}})();(function(d){function a(a,f,c){var h,c=c||"",g=c.match(RegExp("(?:^|\\s|;)("+a+")\\s*:\\s*([^;]*(?:;|$))","i"));g&&(g[0]=g[0].replace(/^;/,""));null===f?h="":"string"===typeof f&&(h=a+":"+f+" !important;");g?("boolean"===typeof f&&(h=d.important(a+":"+g[2],f)),c=c.replace(g[0],h)):"undefined"!==typeof h&&(c=d.trim(c),""!==c&&(";"!==c.slice(-1)&&(c+=";"),c+=" "),c+=h);return c}function g(a,d){var c=g.re;if(!c)c=g.re=/\s*(! ?important)?[\s\r\t\n]*;/g;return!1===d?a.replace(c,";"):a.replace(c,function(a,
d){return d?a:" !important;"})}function h(a,d){var c=h.re;if(!c)c=h.re=/(?=<style[^>]*>)([\w\W]*?)(?=<\/style>)/g;return a.replace(c,function(a,c){return g(c,d)})}var c=!1,f={},l={},j=d.each({css:function(c,h){var g={},l=d(this),j=l.attr("style");if("string"===typeof c){if("undefined"===typeof h)return f.css.apply(this,arguments);g[c]=h}else if("object"===typeof c)g=c;else return l;d.each(g,function(c,d){j=a(c,d,j)});return l.attr("style",j)}},function(a,h){f[a]=d.fn[a];h.overridden=!0;l[a]=function(){var g=
d.makeArray(arguments),l=g[g.length-1],j=d(this);return!0===l?h.apply(j,g.slice(0,-1)):c&&!1!==l?h.apply(j,g):f[a].apply(j,g)}});d.extend(d.fn,l);d.important=d.extend(function(){var a=d.makeArray(arguments),f;if("string"===typeof a[0]){if("undefined"===typeof a[1]||"boolean"===typeof a[1])return f=!1!==a[1],/<\w+.*>/.test(a[0])?h(a[0],f):g(a[0],f)}else if(d.isFunction(a[0]))f=c,d.important.status=c=!0,a[0].call(this),d.important.status=c=f;else if("undefined"===typeof a[0]||"boolean"===typeof a[0])d.important.status=
c=!1!==a[0];return c},{status:c,noConflict:function(){d.each(f,function(a,c){d.fn[a]=c});return j},declaration:a});d.fn.important=function(c){var f=d(this),h=d.makeArray(arguments).concat(!0),j=f.data("nodeName"),o;if("undefined"===typeof c||"boolean"===typeof c)j||(j=f.attr("nodeName").toLowerCase(),f.data("nodeName",j)),"style"===j?(o=!1!==c,f.html(g(f.html(),o)),h=f.attr("sheet"),_("stylesheet",h),h&&h.cssRules&&(_("cssRules",h.cssRules),d.each(h.cssRules,function(a,c){_("rule",c,c.cssText);_(d.important(c.style.cssText,
o));if(c.type===CSSRule.STYLE_RULE)c.style.cssText=d.important(c.style.cssText,o)}))):f.attr("style",d.important(f.attr("style"),c));else{if("object"===typeof c)return h.unshift("css"),f.important.apply(this,h);if("string"===typeof c)if(d.isFunction(l[c]))h=h.slice(1),l[c].apply(f,h);else{if("undefined"===typeof h[1]||"boolean"===typeof h[1])o=!1!==h[1],f.attr("style",a(c,o,f.attr("style")))}else d.isFunction(c)&&d.important.call(this,c)}return f}})(jQuery);(function(d){var a=function(a){var c=a.data("scrollbarPaper")||a.data("scrollbar-paper"),f=a.innerHeight(),d=f-a.height();return{height:f,ratio:f/(c.clearer.position().top-((c.content.children(":visible").eq(0).position()||{}).top||0)+d),offset:a.offset()}},g={_init:function(h){h=d.extend({parentSelector:"",css:d.css,show:function(a){a.show()},hide:function(a){a.hide()}},h);return this.each(function(){var c=d(this),f=c.data("scrollbarPaper")||c.data("scrollbar-paper");if(!f){h.css.apply(c,[{"overflow-x":"hidden",
"overflow-y":"auto"},!0]);f=c.closest(h.parentSelector);f.length||(f=c.offsetParent());var g=d('<div class="scrollbarpaper-container"></div>').appendTo(f);h.hide(g);var j=d('<div class="scrollbarpaper-track"></div>').appendTo(g),m=d('<div class="scrollbarpaper-drag"></div>').appendTo(j),f={options:h,offsetParent:f,paper:g,track:j,drag:m,dragTop:d('<div class="scrollbarpaper-drag-top"></div>').appendTo(m),dragBottom:d('<div class="scrollbarpaper-drag-bottom"></div>').appendTo(m),content:c,clearer:d('<div style="clear:both;"></div>').appendTo(c),
offsetHeight:j.outerHeight()-j.height()};c.data("scrollbarPaper",f).data("scrollbar-paper",f);var q=a(c),u=setInterval(function(){if(c.closest(h.parentSelector).length){if(c.is(":visible")){var f=a(c);if(f.height!=q.height||f.ratio!=q.ratio||f.offset.left!=q.offset.left||f.offset.top!=q.offset.top)c.scrollbarPaper("update"),q=f}}else clearInterval(u),g.remove()},250)}c.scrollbarPaper("update")})},update:function(h){return this.each(function(){var c=d(this);if(c.is(":visible")&&!c.data("scrollbarpaperfrozen")){var f=
c.data("scrollbarPaper")||c.data("scrollbar-paper");h=h||a(c);c.unbind(".scrollbarPaper");var g=c.innerHeight()-f.offsetHeight;f.options.css.apply(f.track,[{height:g+"px"},!0]);var j=0<f.offsetParent.not("html, body").length?f.offsetParent.offset():{left:0,top:0};f.options.css.apply(f.paper,[{left:-j.left+h.offset.left+c.innerWidth()-f.paper.width()+"px",top:-j.top+h.offset.top+"px"},!0]);var m=Math.max(Math.round(g*h.ratio),f.dragTop.height()+f.dragBottom.height());f.options.css.apply(f.drag,[{height:m+
"px"},!0]);j=function(){f.options.css.apply(f.drag,[{top:Math.min(Math.round(c.scrollTop()*h.ratio),g-m)+"px"},!0])};j();c.bind("scroll.scrollbarPaper",j);var q=function(a){return a.pageY||(a.originalEvent&&(a.originalEvent.targetTouches||a.originalEvent.touches||[])[0]||a).pageY},u=function(){d("body").unbind("mousemove.scrollbarPaper touchmove.scrollbarPaper")};f.drag.bind("mousedown.scrollbarPaper touchstart.scrollbarPaper",function(a){u();var g=q(a)-f.drag.offset().top;d("body").bind("mousemove.scrollbarPaper touchmove.scrollbarPaper",
function(a){a.preventDefault();c.scrollTop((q(a)-c.offset().top-g)/h.ratio);return!1}).bind("mouseup.scrollbarPaper touchend.scrollbarPaper",u);return!1});1>h.ratio?(f.options.show(f.drag),f.content.addClass("scrollbarpaper-visible")):(f.options.hide(f.drag),f.content.removeClass("scrollbarpaper-visible"))}})},show:function(){return this.each(function(){var a=d(this),c=a.data("scrollbarPaper")||a.data("scrollbar-paper");c&&(a.scrollbarPaper("update"),"function"==typeof c.options.show?c.options.show(c.paper):
c.paper.show())})},hide:function(){return this.each(function(){var a=d(this);(a=a.data("scrollbarPaper")||a.data("scrollbar-paper"))&&("function"==typeof a.options.hide?a.options.hide(a.paper):a.paper.hide())})},freeze:function(){return this.each(function(){d(this).data("scrollbarpaperfrozen",!0)})},thaw:function(){return this.each(function(){d(this).data("scrollbarpaperfrozen",!1)})}};d.fn.scrollbarPaper=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===
typeof a||!a)return g._init.apply(this,arguments);throw"Method "+a+" does not exist on jQuery.scrollbarPaper.";}})(jQuery);(function(){function d(k,b,a){if(k===b)return 0!==k||1/k==1/b;if(null==k||null==b)return k===b;k._chain&&(k=k._wrapped);b._chain&&(b=b._wrapped);if(k.isEqual&&e.isFunction(k.isEqual))return k.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(k);var i=m.call(k);if(i!=m.call(b))return!1;switch(i){case "[object String]":return k==""+b;case "[object Number]":return k!=+k?b!=+b:0==k?1/k==1/b:k==+b;case "[object Date]":case "[object Boolean]":return+k==+b;case "[object RegExp]":return k.source==
b.source&&k.global==b.global&&k.multiline==b.multiline&&k.ignoreCase==b.ignoreCase}if("object"!=typeof k||"object"!=typeof b)return!1;for(var c=a.length;c--;)if(a[c]==k)return!0;a.push(k);var c=0,f=!0;if("[object Array]"==i){if(c=k.length,f=c==b.length)for(;c--&&(f=c in k==c in b&&d(k[c],b[c],a)););}else{if("constructor"in k!="constructor"in b||k.constructor!=b.constructor)return!1;for(var t in k)if(e.has(k,t)&&(c++,!(f=e.has(b,t)&&d(k[t],b[t],a))))break;if(f){for(t in b)if(e.has(b,t)&&!c--)break;
f=!c}}a.pop();return f}var a=this,g=a._,h={},c=Array.prototype,f=Object.prototype,l=c.slice,j=c.unshift,m=f.toString,q=f.hasOwnProperty,u=c.forEach,x=c.map,o=c.reduce,y=c.reduceRight,v=c.filter,r=c.every,s=c.some,n=c.indexOf,B=c.lastIndexOf,f=Array.isArray,E=Object.keys,A=Function.prototype.bind,e=function(b){return new z(b)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):a._=e;e.VERSION="1.3.3";var p=e.each=e.forEach=function(b,
a,i){if(null!=b)if(u&&b.forEach===u)b.forEach(a,i);else if(b.length===+b.length)for(var c=0,f=b.length;c<f&&!(c in b&&a.call(i,b[c],c,b)===h);c++);else for(c in b)if(e.has(b,c)&&a.call(i,b[c],c,b)===h)break};e.map=e.collect=function(b,a,i){var c=[];if(null==b)return c;if(x&&b.map===x)return b.map(a,i);p(b,function(b,k,f){c[c.length]=a.call(i,b,k,f)});if(b.length===+b.length)c.length=b.length;return c};e.reduce=e.foldl=e.inject=function(b,a,c,i){var f=2<arguments.length;null==b&&(b=[]);if(o&&b.reduce===
o)return i&&(a=e.bind(a,i)),f?b.reduce(a,c):b.reduce(a);p(b,function(b,k,e){f?c=a.call(i,c,b,k,e):(c=b,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(b,a,c,i){var f=2<arguments.length;null==b&&(b=[]);if(y&&b.reduceRight===y)return i&&(a=e.bind(a,i)),f?b.reduceRight(a,c):b.reduceRight(a);var d=e.toArray(b).reverse();i&&!f&&(a=e.bind(a,i));return f?e.reduce(d,a,c,i):e.reduce(d,a)};e.find=e.detect=function(b,a,c){var i;C(b,function(b,
k,f){if(a.call(c,b,k,f))return i=b,!0});return i};e.filter=e.select=function(b,a,c){var i=[];if(null==b)return i;if(v&&b.filter===v)return b.filter(a,c);p(b,function(b,k,f){a.call(c,b,k,f)&&(i[i.length]=b)});return i};e.reject=function(b,a,i){var c=[];if(null==b)return c;p(b,function(b,k,f){a.call(i,b,k,f)||(c[c.length]=b)});return c};e.every=e.all=function(b,a,c){var i=!0;if(null==b)return i;if(r&&b.every===r)return b.every(a,c);p(b,function(b,k,f){if(!(i=i&&a.call(c,b,k,f)))return h});return!!i};
var C=e.some=e.any=function(b,a,i){a||(a=e.identity);var c=!1;if(null==b)return c;if(s&&b.some===s)return b.some(a,i);p(b,function(b,k,f){if(c||(c=a.call(i,b,k,f)))return h});return!!c};e.include=e.contains=function(b,a){var c;return null==b?!1:n&&b.indexOf===n?-1!=b.indexOf(a):c=C(b,function(b){return b===a})};e.invoke=function(b,a){var c=l.call(arguments,2);return e.map(b,function(b){return(e.isFunction(a)?a||b:b[a]).apply(b,c)})};e.pluck=function(b,a){return e.map(b,function(b){return b[a]})};
e.max=function(b,a,c){if(!a&&e.isArray(b)&&b[0]===+b[0])return Math.max.apply(Math,b);if(!a&&e.isEmpty(b))return-Infinity;var i={computed:-Infinity};p(b,function(b,k,f){k=a?a.call(c,b,k,f):b;k>=i.computed&&(i={value:b,computed:k})});return i.value};e.min=function(b,a,c){if(!a&&e.isArray(b)&&b[0]===+b[0])return Math.min.apply(Math,b);if(!a&&e.isEmpty(b))return Infinity;var i={computed:Infinity};p(b,function(b,k,f){k=a?a.call(c,b,k,f):b;k<i.computed&&(i={value:b,computed:k})});return i.value};e.shuffle=
function(b){var a=[],c;p(b,function(b,k){c=Math.floor(Math.random()*(k+1));a[k]=a[c];a[c]=b});return a};e.sortBy=function(b,a,c){var i=e.isFunction(a)?a:function(b){return b[a]};return e.pluck(e.map(b,function(b,a,k){return{value:b,criteria:i.call(c,b,a,k)}}).sort(function(b,a){var k=b.criteria,c=a.criteria;return void 0===k?1:void 0===c?-1:k<c?-1:k>c?1:0}),"value")};e.groupBy=function(b,a){var c={},i=e.isFunction(a)?a:function(b){return b[a]};p(b,function(b,a){var k=i(b,a);(c[k]||(c[k]=[])).push(b)});
return c};e.sortedIndex=function(b,a,c){c||(c=e.identity);for(var i=0,f=b.length;i<f;){var d=i+f>>1;c(b[d])<c(a)?i=d+1:f=d}return i};e.toArray=function(b){return!b?[]:e.isArray(b)||e.isArguments(b)?l.call(b):b.toArray&&e.isFunction(b.toArray)?b.toArray():e.values(b)};e.size=function(b){return e.isArray(b)?b.length:e.keys(b).length};e.first=e.head=e.take=function(b,a,c){return null!=a&&!c?l.call(b,0,a):b[0]};e.initial=function(b,a,c){return l.call(b,0,b.length-(null==a||c?1:a))};e.last=function(b,
a,c){return null!=a&&!c?l.call(b,Math.max(b.length-a,0)):b[b.length-1]};e.rest=e.tail=function(b,a,c){return l.call(b,null==a||c?1:a)};e.compact=function(b){return e.filter(b,function(b){return!!b})};e.flatten=function(b,a){return e.reduce(b,function(b,c){if(e.isArray(c))return b.concat(a?c:e.flatten(c));b[b.length]=c;return b},[])};e.without=function(b){return e.difference(b,l.call(arguments,1))};e.uniq=e.unique=function(b,a,c){var c=c?e.map(b,c):b,i=[];3>b.length&&(a=!0);e.reduce(c,function(c,f,
d){if(a?e.last(c)!==f||!c.length:!e.include(c,f))c.push(f),i.push(b[d]);return c},[]);return i};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(b){var a=l.call(arguments,1);return e.filter(e.uniq(b),function(b){return e.every(a,function(a){return 0<=e.indexOf(a,b)})})};e.difference=function(b){var a=e.flatten(l.call(arguments,1),!0);return e.filter(b,function(b){return!e.include(a,b)})};e.zip=function(){for(var b=l.call(arguments),a=e.max(e.pluck(b,"length")),
c=Array(a),i=0;i<a;i++)c[i]=e.pluck(b,""+i);return c};e.indexOf=function(b,a,c){if(null==b)return-1;var i;if(c)return c=e.sortedIndex(b,a),b[c]===a?c:-1;if(n&&b.indexOf===n)return b.indexOf(a);c=0;for(i=b.length;c<i;c++)if(c in b&&b[c]===a)return c;return-1};e.lastIndexOf=function(b,a){if(null==b)return-1;if(B&&b.lastIndexOf===B)return b.lastIndexOf(a);for(var c=b.length;c--;)if(c in b&&b[c]===a)return c;return-1};e.range=function(b,a,c){1>=arguments.length&&(a=b||0,b=0);for(var c=arguments[2]||1,
i=Math.max(Math.ceil((a-b)/c),0),f=0,d=Array(i);f<i;)d[f++]=b,b+=c;return d};var w=function(){};e.bind=function(b,a){var c,i;if(b.bind===A&&A)return A.apply(b,l.call(arguments,1));if(!e.isFunction(b))throw new TypeError;i=l.call(arguments,2);return c=function(){if(!(this instanceof c))return b.apply(a,i.concat(l.call(arguments)));w.prototype=b.prototype;var f=new w,d=b.apply(f,i.concat(l.call(arguments)));return Object(d)===d?d:f}};e.bindAll=function(b){var a=l.call(arguments,1);0==a.length&&(a=e.functions(b));
p(a,function(a){b[a]=e.bind(b[a],b)});return b};e.memoize=function(b,a){var c={};a||(a=e.identity);return function(){var i=a.apply(this,arguments);return e.has(c,i)?c[i]:c[i]=b.apply(this,arguments)}};e.delay=function(b,a){var c=l.call(arguments,2);return setTimeout(function(){return b.apply(null,c)},a)};e.defer=function(b){return e.delay.apply(e,[b,1].concat(l.call(arguments,1)))};e.throttle=function(b,a){var c,i,f,d,t,g,h=e.debounce(function(){t=d=!1},a);return function(){c=this;i=arguments;f||
(f=setTimeout(function(){f=null;t&&b.apply(c,i);h()},a));d?t=!0:g=b.apply(c,i);h();d=!0;return g}};e.debounce=function(b,a,c){var i;return function(){var f=this,d=arguments;c&&!i&&b.apply(f,d);clearTimeout(i);i=setTimeout(function(){i=null;c||b.apply(f,d)},a)}};e.once=function(b){var a=!1,c;return function(){if(a)return c;a=!0;return c=b.apply(this,arguments)}};e.wrap=function(b,a){return function(){var c=[b].concat(l.call(arguments,0));return a.apply(this,c)}};e.compose=function(){var b=arguments;
return function(){for(var a=arguments,c=b.length-1;0<=c;c--)a=[b[c].apply(this,a)];return a[0]}};e.after=function(b,a){return 0>=b?a():function(){if(1>--b)return a.apply(this,arguments)}};e.keys=E||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var a=[],c;for(c in b)e.has(b,c)&&(a[a.length]=c);return a};e.values=function(b){return e.map(b,e.identity)};e.functions=e.methods=function(b){var a=[],c;for(c in b)e.isFunction(b[c])&&a.push(c);return a.sort()};e.extend=function(b){p(l.call(arguments,
1),function(a){for(var c in a)b[c]=a[c]});return b};e.pick=function(b){var a={};p(e.flatten(l.call(arguments,1)),function(c){c in b&&(a[c]=b[c])});return a};e.defaults=function(b){p(l.call(arguments,1),function(a){for(var c in a)null==b[c]&&(b[c]=a[c])});return b};e.clone=function(b){return!e.isObject(b)?b:e.isArray(b)?b.slice():e.extend({},b)};e.tap=function(b,a){a(b);return b};e.isEqual=function(b,a){return d(b,a,[])};e.isEmpty=function(b){if(null==b)return!0;if(e.isArray(b)||e.isString(b))return 0===
b.length;for(var a in b)if(e.has(b,a))return!1;return!0};e.isElement=function(b){return!!(b&&1==b.nodeType)};e.isArray=f||function(b){return"[object Array]"==m.call(b)};e.isObject=function(b){return b===Object(b)};e.isArguments=function(b){return"[object Arguments]"==m.call(b)};e.isArguments(arguments)||(e.isArguments=function(b){return!(!b||!e.has(b,"callee"))});e.isFunction=function(b){return"[object Function]"==m.call(b)};e.isString=function(b){return"[object String]"==m.call(b)};e.isNumber=function(b){return"[object Number]"==
m.call(b)};e.isFinite=function(b){return e.isNumber(b)&&isFinite(b)};e.isNaN=function(b){return b!==b};e.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==m.call(b)};e.isDate=function(b){return"[object Date]"==m.call(b)};e.isRegExp=function(b){return"[object RegExp]"==m.call(b)};e.isNull=function(b){return null===b};e.isUndefined=function(b){return void 0===b};e.has=function(b,a){return q.call(b,a)};e.noConflict=function(){a._=g;return this};e.identity=function(b){return b};e.times=
function(b,a,c){for(var i=0;i<b;i++)a.call(c,i)};e.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(b,a){if(null==b)return null;var c=b[a];return e.isFunction(c)?c.call(b):c};e.mixin=function(b){p(e.functions(b),function(a){H(a,e[a]=b[a])})};var D=0;e.uniqueId=function(b){var a=D++;return b?b+a:a};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var b=/.^/,i={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},t;for(t in i)i[i[t]]=t;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,F=function(b){return b.replace(J,function(b,a){return i[a]})};e.template=function(a,c,f){f=e.defaults(f||{},e.templateSettings);a="__p+='"+a.replace(I,function(b){return"\\"+i[b]}).replace(f.escape||b,function(b,a){return"'+\n_.escape("+F(a)+")+\n'"}).replace(f.interpolate||b,function(b,a){return"'+\n("+
F(a)+")+\n'"}).replace(f.evaluate||b,function(b,a){return"';\n"+F(a)+"\n;__p+='"})+"';\n";f.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(f.variable||"obj","_",a);if(c)return d(c,e);c=function(b){return d.call(this,b,e)};c.source="function("+(f.variable||"obj")+"){\n"+a+"}";return c};e.chain=function(b){return e(b).chain()};var z=function(b){this._wrapped=b};e.prototype=z.prototype;
var G=function(b,a){return a?e(b).chain():b},H=function(b,a){z.prototype[b]=function(){var b=l.call(arguments);j.call(b,this._wrapped);return G(a.apply(e,b),this._chain)}};e.mixin(e);p("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var a=c[b];z.prototype[b]=function(){var c=this._wrapped;a.apply(c,arguments);var i=c.length;("shift"==b||"splice"==b)&&0===i&&delete c[0];return G(c,this._chain)}});p(["concat","join","slice"],function(b){var a=c[b];z.prototype[b]=function(){return G(a.apply(this._wrapped,
arguments),this._chain)}});z.prototype.chain=function(){this._chain=!0;return this};z.prototype.value=function(){return this._wrapped}}).call(this);(function(){var d=this,a=d.Backbone,g=Array.prototype.slice,h=Array.prototype.splice,c;c="undefined"!==typeof exports?exports:d.Backbone={};c.VERSION="0.9.2";var f=d._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var l=d.jQuery||d.Zepto||d.ender;c.setDomLibrary=function(b){l=b};c.noConflict=function(){d.Backbone=a;return this};c.emulateHTTP=!1;c.emulateJSON=!1;var j=/\s+/,m=c.Events={on:function(b,a,c){var f,d,e,g,h;if(!a)return this;b=b.split(j);for(f=this._callbacks||(this._callbacks=
{});d=b.shift();)e=(h=f[d])?h.tail:{},e.next=g={},e.context=c,e.callback=a,f[d]={tail:g,next:h?h.next:e};return this},off:function(b,a,c){var d,e,g,h,l,m;if(e=this._callbacks){if(!b&&!a&&!c)return delete this._callbacks,this;for(b=b?b.split(j):f.keys(e);d=b.shift();)if(g=e[d],delete e[d],g&&(a||c))for(h=g.tail;(g=g.next)!==h;)if(l=g.callback,m=g.context,a&&l!==a||c&&m!==c)this.on(d,l,m);return this}},trigger:function(b){var a,c,f,d,e,h;if(!(f=this._callbacks))return this;e=f.all;b=b.split(j);for(h=
g.call(arguments,1);a=b.shift();){if(c=f[a])for(d=c.tail;(c=c.next)!==d;)c.callback.apply(c.context||this,h);if(c=e){d=c.tail;for(a=[a].concat(h);(c=c.next)!==d;)c.callback.apply(c.context||this,a)}}return this}};m.bind=m.on;m.unbind=m.off;var q=c.Model=function(b,a){var c;b||(b={});a&&a.parse&&(b=this.parse(b));if(c=w(this,"defaults"))b=f.extend({},c,b);a&&a.collection&&(this.collection=a.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(b,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(q.prototype,m,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(b){return this.attributes[b]},escape:function(b){var a;if(a=this._escapedAttributes[b])return a;a=this.get(b);return this._escapedAttributes[b]=f.escape(null==
a?"":""+a)},has:function(b){return null!=this.get(b)},set:function(b,a,c){var d,e;f.isObject(b)||null==b?(d=b,c=a):(d={},d[b]=a);c||(c={});if(!d)return this;d instanceof q&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var a=c.changes={},g=this.attributes,h=this._escapedAttributes,l=this._previousAttributes||{};for(e in d){b=d[e];if(!f.isEqual(g[e],b)||c.unset&&f.has(g,e))delete h[e],(c.silent?this._silent:
a)[e]=!0;c.unset?delete g[e]:g[e]=b;!f.isEqual(l[e],b)||f.has(g,e)!=f.has(l,e)?(this.changed[e]=b,c.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}c.silent||this.change(c);return this},unset:function(b,a){(a||(a={})).unset=!0;return this.set(b,null,a)},clear:function(b){(b||(b={})).unset=!0;return this.set(f.clone(this.attributes),b)},fetch:function(b){var b=b?f.clone(b):{},a=this,d=b.success;b.success=function(c,f,e){if(!a.set(a.parse(c,e),b))return!1;d&&d(a,c)};
b.error=c.wrapError(b.error,a,b);return(this.sync||c.sync).call(this,"read",this,b)},save:function(b,a,d){var e,g;f.isObject(b)||null==b?(e=b,d=a):(e={},e[b]=a);d=d?f.clone(d):{};if(d.wait){if(!this._validate(e,d))return!1;g=f.clone(this.attributes)}b=f.extend({},d,{silent:!0});if(e&&!this.set(e,d.wait?b:d))return!1;var h=this,l=d.success;d.success=function(b,a,c){a=h.parse(b,c);d.wait&&(delete d.wait,a=f.extend(e||{},a));if(!h.set(a,d))return!1;l?l(h,b):h.trigger("sync",h,b,d)};d.error=c.wrapError(d.error,
h,d);a=this.isNew()?"create":"update";a=(this.sync||c.sync).call(this,a,this,d);d.wait&&this.set(g,b);return a},destroy:function(b){var b=b?f.clone(b):{},a=this,d=b.success,e=function(){a.trigger("destroy",a,a.collection,b)};if(this.isNew())return e(),!1;b.success=function(c){b.wait&&e();d?d(a,c):a.trigger("sync",a,c,b)};b.error=c.wrapError(b.error,a,b);var g=(this.sync||c.sync).call(this,"delete",this,b);b.wait||e();return g},url:function(){var b=w(this,"urlRoot")||w(this.collection,"url")||D();
return this.isNew()?b:b+("/"==b.charAt(b.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(b){return b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(b){b||(b={});var a=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=f.extend({},b.changes,this._silent);this._silent={};for(c in d)this.trigger("change:"+c,this,this.get(c),b);if(a)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,b);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(b){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,b)},changedAttributes:function(b){if(!b)return this.hasChanged()?f.clone(this.changed):!1;var a,c=!1,d=this._previousAttributes,e;for(e in b)if(!f.isEqual(d[e],a=b[e]))(c||(c={}))[e]=a;return c},previous:function(b){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[b]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(b,a){if(a.silent||!this.validate)return!0;var b=f.extend({},this.attributes,b),c=this.validate(b,a);if(!c)return!0;a&&a.error?a.error(this,c,a):this.trigger("error",this,c,a);return!1}});var u=c.Collection=function(b,a){a||(a={});a.model&&(this.model=a.model);a.comparator&&(this.comparator=a.comparator);
this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0,parse:a.parse})};f.extend(u.prototype,m,{model:q,initialize:function(){},toJSON:function(b){return this.map(function(a){return a.toJSON(b)})},add:function(b,a){var c,d,e,g,l,j={},m={},k=[];a||(a={});b=f.isArray(b)?b.slice():[b];c=0;for(d=b.length;c<d;c++){if(!(e=b[c]=this._prepareModel(b[c],a)))throw Error("Can't add an invalid model to a collection");g=e.cid;l=e.id;j[g]||this._byCid[g]||null!=l&&(m[l]||this._byId[l])?
k.push(c):j[g]=m[l]=e}for(c=k.length;c--;)b.splice(k[c],1);c=0;for(d=b.length;c<d;c++)(e=b[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=e.id&&(this._byId[e.id]=e);this.length+=d;h.apply(this.models,[null!=a.at?a.at:this.models.length,0].concat(b));this.comparator&&this.sort({silent:!0});if(a.silent)return this;c=0;for(d=this.models.length;c<d;c++)if(j[(e=this.models[c]).cid])a.index=c,e.trigger("add",e,this,a);return this},remove:function(b,a){var c,d,e,g;a||(a={});b=f.isArray(b)?
b.slice():[b];c=0;for(d=b.length;c<d;c++)if(g=this.getByCid(b[c])||this.get(b[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,a.silent||(a.index=e,g.trigger("remove",g,this,a)),this._removeReference(g);return this},push:function(b,a){b=this._prepareModel(b,a);this.add(b,a);return b},pop:function(b){var a=this.at(this.length-1);this.remove(a,b);return a},unshift:function(b,a){b=this._prepareModel(b,a);this.add(b,f.extend({at:0},a));return b},
shift:function(b){var a=this.at(0);this.remove(a,b);return a},get:function(b){return null==b?void 0:this._byId[null!=b.id?b.id:b]},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b){return f.isEmpty(b)?[]:this.filter(function(a){for(var c in b)if(b[c]!==a.get(c))return!1;return!0})},sort:function(b){b||(b={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var a=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(a):this.models.sort(a);b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return f.map(this.models,function(a){return a.get(b)})},reset:function(b,a){b||(b=[]);a||(a={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(b,f.extend({silent:!0},a));a.silent||this.trigger("reset",this,a);return this},fetch:function(b){b=b?f.clone(b):{};void 0===b.parse&&(b.parse=!0);var a=this,d=b.success;b.success=function(c,
f,e){a[b.add?"add":"reset"](a.parse(c,e),b);d&&d(a,c)};b.error=c.wrapError(b.error,a,b);return(this.sync||c.sync).call(this,"read",this,b)},create:function(b,a){var c=this,a=a?f.clone(a):{},b=this._prepareModel(b,a);if(!b)return!1;a.wait||c.add(b,a);var d=a.success;a.success=function(f,e){a.wait&&c.add(f,a);d?d(f,e):f.trigger("sync",b,e,a)};b.save(null,a);return b},parse:function(b){return b},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(b,a){a||(a={});b instanceof q?b.collection||(b.collection=this):(a.collection=this,b=new this.model(b,a),b._validate(b.attributes,a)||(b=!1));return b},_removeReference:function(b){this==b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,a,c,d){("add"==b||"remove"==b)&&c!=this||("destroy"==b&&this.remove(a,d),a&&b==="change:"+a.idAttribute&&(delete this._byId[a.previous(a.idAttribute)],this._byId[a.id]=a),this.trigger.apply(this,
arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(b){u.prototype[b]=function(){return f[b].apply(f,[this.models].concat(f.toArray(arguments)))}});var x=c.Router=function(b){b||(b={});b.routes&&(this.routes=b.routes);this._bindRoutes();this.initialize.apply(this,arguments)},o=/:\w+/g,
y=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(x.prototype,m,{initialize:function(){},route:function(b,a,d){c.history||(c.history=new r);f.isRegExp(b)||(b=this._routeToRegExp(b));d||(d=this[a]);c.history.route(b,f.bind(function(f){f=this._extractParameters(b,f);d&&d.apply(this,f);this.trigger.apply(this,["route:"+a].concat(f));c.history.trigger("route",this,a,f)},this));return this},navigate:function(b,a){c.history.navigate(b,a)},_bindRoutes:function(){if(this.routes){var b=[],a;for(a in this.routes)b.unshift([a,
this.routes[a]]);a=0;for(var c=b.length;a<c;a++)this.route(b[a][0],b[a][1],this[b[a][1]])}},_routeToRegExp:function(b){b=b.replace(v,"\\$&").replace(o,"([^/]+)").replace(y,"(.*?)");return RegExp("^"+b+"$")},_extractParameters:function(b,a){return b.exec(a).slice(1)}});var r=c.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},s=/^[#\/]/,n=/msie [\w.]+/;r.started=!1;f.extend(r.prototype,m,{interval:50,getHash:function(b){return(b=(b?b.location:window.location).href.match(/#(.*)$/))?b[1]:
""},getFragment:function(b,a){if(null==b)if(this._hasPushState||a){var b=window.location.pathname,c=window.location.search;c&&(b+=c)}else b=this.getHash();b.indexOf(this.options.root)||(b=b.substr(this.options.root.length));return b.replace(s,"")},start:function(b){if(r.started)throw Error("Backbone.history has already been started");r.started=!0;this.options=f.extend({},{root:"/"},this.options,b);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var b=this.getFragment(),a=document.documentMode;if(a=n.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a))this.iframe=l('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b);this._hasPushState?l(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?l(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=b;b=window.location;a=b.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&a&&b.hash&&(this.fragment=this.getHash().replace(s,""),window.history.replaceState({},document.title,b.protocol+"//"+b.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){l(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);r.started=!1},route:function(b,a){this.handlers.unshift({route:b,callback:a})},checkUrl:function(){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));if(b==this.fragment)return!1;this.iframe&&this.navigate(b);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(b){var a=this.fragment=this.getFragment(b);return f.any(this.handlers,
function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(b,a){if(!r.started)return!1;if(!a||!0===a)a={trigger:a};var c=(b||"").replace(s,"");this.fragment!=c&&(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=this.options.root+c),this.fragment=c,window.history[a.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,a.replace),this.iframe&&c!=this.getFragment(this.getHash(this.iframe))&&(a.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,a.replace))):window.location.assign(this.options.root+b),a.trigger&&this.loadUrl(b))},_updateHash:function(b,a,c){c?b.replace(b.toString().replace(/(javascript:|#).*$/,"")+"#"+a):b.hash=a}});var B=c.View=function(b){this.cid=f.uniqueId("view");this._configure(b||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},E=/^(\S+)\s*(.*)$/,A="model,collection,el,id,attributes,className,tagName".split(",");
f.extend(B.prototype,m,{tagName:"div",$:function(b){return this.$el.find(b)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(b,a,c){b=document.createElement(b);a&&l(b).attr(a);c&&l(b).html(c);return b},setElement:function(b,a){this.$el&&this.undelegateEvents();this.$el=b instanceof l?b:l(b);this.el=this.$el[0];!1!==a&&this.delegateEvents();return this},delegateEvents:function(b){if(b||(b=w(this,"events"))){this.undelegateEvents();
for(var a in b){var c=b[a];f.isFunction(c)||(c=this[b[a]]);if(!c)throw Error('Method "'+b[a]+'" does not exist');var d=a.match(E),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var c=0,d=A.length;c<d;c++){var e=A[c];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=w(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});q.extend=u.extend=x.extend=B.extend=function(a,c){var d=C(this,a,c);d.extend=this.extend;return d};var e={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};c.sync=function(a,d,g){var h=e[a];g||(g={});var j={type:h,dataType:"json"};g.url||(j.url=w(d,"url")||D());if(!g.data&&d&&("create"==a||"update"==a))j.contentType="application/json",
j.data=JSON.stringify(d.toJSON());c.emulateJSON&&(j.contentType="application/x-www-form-urlencoded",j.data=j.data?{model:j.data}:{});if(c.emulateHTTP&&("PUT"===h||"DELETE"===h))c.emulateJSON&&(j.data._method=h),j.type="POST",j.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",h)};"GET"!==j.type&&!c.emulateJSON&&(j.processData=!1);return l.ajax(f.extend(j,g))};c.wrapError=function(a,c,d){return function(f,e){e=f===c?e:f;a?a(c,e,d):c.trigger("error",c,e,d)}};var p=function(){},C=function(a,
c,d){var e;e=c&&c.hasOwnProperty("constructor")?c.constructor:function(){a.apply(this,arguments)};f.extend(e,a);p.prototype=a.prototype;e.prototype=new p;c&&f.extend(e.prototype,c);d&&f.extend(e,d);e.prototype.constructor=e;e.__super__=a.prototype;return e},w=function(a,c){return!a||!a[c]?null:f.isFunction(a[c])?a[c]():a[c]},D=function(){throw Error('A "url" property or function must be specified');}}).call(this);function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}window.Store=function(d){this.name=d;this.records=(d=localStorage.getItem(this.name))&&d.split(",")||[]};
_.extend(Store.prototype,{save:function(){localStorage.setItem(this.name,this.records.join(","))},create:function(d){if(!d.id)d.id=d.attributes.id=guid();localStorage.setItem(this.name+"-"+d.id,JSON.stringify(d));this.records.push(d.id.toString());this.save();return d},update:function(d){localStorage.setItem(this.name+"-"+d.id,JSON.stringify(d));_.include(this.records,d.id.toString())||this.records.push(d.id.toString());this.save();return d},find:function(d){return JSON.parse(localStorage.getItem(this.name+
"-"+d.id))},findAll:function(){return _.map(this.records,function(d){return JSON.parse(localStorage.getItem(this.name+"-"+d))},this)},destroy:function(d){localStorage.removeItem(this.name+"-"+d.id);this.records=_.reject(this.records,function(a){return a==d.id.toString()});this.save();return d}});Backbone.remoteSync=Backbone.sync;
Backbone.sync=function(d,a,g,h){"function"==typeof g&&(g={success:g,error:h});var c,f=a.localStorage||a.collection&&a.collection.localStorage;if(!f)return Backbone.remoteSync(d,a,g,h);switch(d){case "read":c=a.id?f.find(a):f.findAll();break;case "create":c=f.create(a);break;case "update":c=f.update(a);break;case "delete":c=f.destroy(a)}c?g.success(c):g.error("Record not found")};window.Modernizr=function(d,a,g){function h(a,d){var f=a.charAt(0).toUpperCase()+a.substr(1),f=(a+" "+q.join(f+" ")+f).split(" ");return c(f,d)}function c(a,c){for(var d in a)if(m[a[d]]!==g)return"pfx"==c?a[d]:!0;return!1}var f={},l=a.documentElement;a.head||a.getElementsByTagName("head");var j=a.createElement("modernizr"),m=j.style,d=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),q="Webkit Moz O ms Khtml".split(" "),j={},u=[],x=function(c,d,f,g){var h,e,j=a.createElement("div");if(parseInt(f,10))for(;f--;)e=
a.createElement("div"),e.id=g?g[f]:"modernizr"+(f+1),j.appendChild(e);h=["&shy;<style>",c,"</style>"].join("");j.id="modernizr";j.innerHTML+=h;l.appendChild(j);c=d(j,c);j.parentNode.removeChild(j);return!!c},o,y={}.hasOwnProperty,v;typeof y!==g&&typeof y.call!==g?v=function(a,c){return y.call(a,c)}:v=function(a,c){return c in a&&typeof a.constructor.prototype[c]===g};(function(a,c){var d=a.join(""),g=c.length;x(d,function(a){for(var a=a.childNodes,c={};g--;)c[a[g].id]=a[g];f.csstransforms3d=9===c.csstransforms3d.offsetLeft},
g,c)})([,["@media (",d.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute}}"].join("")],[,"csstransforms3d"]);j.csstransforms=function(){return!!c(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])};j.csstransforms3d=function(){var a=!!c(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);a&&"webkitPerspective"in l.style&&(a=f.csstransforms3d);return a};j.csstransitions=function(){return h("transitionProperty")};
for(var r in j)v(j,r)&&(o=r.toLowerCase(),f[o]=j[r](),u.push((f[o]?"":"no-")+o));m.cssText="";j=null;f._version="2.0.6";f._prefixes=d;f._domPrefixes=q;f.testProp=function(a){return c([a])};f.testAllProps=h;f.testStyles=x;return f}(this,this.document);"undefined"==typeof CFW&&(CFW={});"undefined"==typeof CFW_OPTIONS&&(CFW_OPTIONS={});CFW.domain=/[.]local/.test(window.location.host)||/rinkl/.test(window.location.host)||/squatc/.test(window.location.host)?"http://tameron.herokuapp.com":"http://cfwhiteboard.com";CFW.important=jQuery.important.noConflict();CFW.oxygenTank=function(){var d=Array.prototype.slice.call(arguments),a=d.pop(),d=_.reduceRight(d,function(a,d){return"undefined"!=typeof a?a[d]:a},d.shift());return"undefined"!=typeof d?d:a};
CFW.ajaxOptions=!jQuery.browser.msie||!window.XDomainRequest?{}:{xhr:function(){try{var d=new XDomainRequest;d.timeout=5E3;var a;d.getAllResponseHeaders=function(){return""};var g=function(c,g){d.onload=d.onerror=d.ontimeout=jQuery.noop;d.status=c;d.statusText=g;d.readyState=4;if(a)d.responseText=a.responseText;d.onreadystatechange&&d.onreadystatechange()},h=function(){a=new XDomainRequest;a.timeout=d.timeout;a.onload=d.onload;a.onerror=d.onerror;a.ontimeout=d.ontimeout;a.open(d.openArgs[0],d.openArgs[1]);
a.send(d.sendArgs[0])};d.onload=function(){g(200,"OK")};d.onerror=function(){a?g(400,"Error"):h()};d.ontimeout=function(){a?g(0,"timeout"):h()};d.originalOpen=d.open;d.open=function(a,c){"PUT"===a?(c+="/revise",a="POST"):"DELETE"===a&&(c+="/annihilate",a="POST");d.openArgs=[a,c];d.originalOpen(a,c)};d.originalSend=d.send;d.send=function(a){d.sendArgs=[a];setTimeout(function(){d.originalSend(a)},0)};return d}catch(c){return jQuery.ajaxSettings.xhr()}}};
jQuery(function(d){d(document.embeds).each(function(){var a=d(this);setTimeout(function(){var g=!1,h=a.attr("wmode");"opaque"!=h&&"transparent"!=h&&(a.attr("wmode","opaque"),g=!0);var c=a.closest("object"),h=c.children("param[name=wmode]").val();"opaque"!=h&&"transparent"!=h&&(c.prepend(d('<param name="wmode" value="opaque" />')),g=!0);g&&(c=c.length?c:a,g=c.wrap(d('<span class="cfw-placeholder" />')),g.html(g.html()),g.children().unwrap())},d.browser.msie?300:0)});d("iframe").each(function(){/youtube/.test(this.src)&&
(this.src+=(0<=this.src.indexOf("?")?"&":"?")+"wmode=opaque")})});jQuery(function(d){d.fn.bindBefore=function(a,g){a=a.split(/\s+/);this.each(function(){for(var h=a.length;h--;){d(this).bind(a[h],g);var c=d.data(this,"events")[a[h]];c.splice(0,0,c.pop())}})};d.fn.oneBefore=function(a,g){a=a.split(/\s+/);this.each(function(){for(var h=a.length;h--;){d(this).one(a[h],g);var c=d.data(this,"events")[a[h]];c.splice(0,0,c.pop())}})}});
jQuery(function(d){if(!Modernizr.csstransitions)Modernizr.csstransforms=!1,Modernizr.csstransforms3d=!1;if(/AppleWebKit/i.test(navigator.userAgent)&&!/Mobile/i.test(navigator.userAgent))Modernizr.csstransforms3d=!1;if(d.browser.msie&&window.XDomainRequest)jQuery.support.cors=!0;CFW.User=Backbone.Model.extend({defaults:function(){return{email:"",known_as:"",count:0,highlightColor:CFW.User.prototype.randomColor()}},randomColor:function(){return[[255,75,105],[255,105,75],[75,105,255],[105,75,255],[75,
255,105],[105,255,75],[123,6,226],[226,6,123],[6,226,123],[6,123,226]][Math.floor(10*Math.random()+0)]}});CFW.UserList=Backbone.Collection.extend({model:CFW.User,initialize:function(){this.localStorage=new Store("cfw-users");return this},comparator:function(a){return-a.get("count")}});CFW.users=new CFW.UserList;CFW.users.fetch();CFW.Entry=Backbone.Model.extend({idAttribute:"_id",defaults:{athlete_id:"",known_as:"",email:"",component_results:[],notes:""},emailRegex:/^\S+@\S+\.\S+$/,validate:function(a){var d=
[];!(a.athlete_id||this.attributes&&this.get("athlete_id"))&&!this.emailRegex.test(a.email)&&d.push("email");_.each(a.component_results,function(a){(!a.result||!a.result.length)&&d.push("component-"+a.wp_id+"-result")});(!a.known_as||!a.known_as.replace(/^\s+/,"").replace(/\s+$/,"").length)&&d.push("known_as");if(d.length)return d}});CFW.EntryList=Backbone.Collection.extend({model:CFW.Entry,url:function(){return CFW.domain+"/affiliates/"+this.affiliateId+"/wods/"+this.postId+"+"+this.wod.wp_id+"/posts"},
initialize:function(a,d){this.affiliateId=d.affiliateId;this.postId=d.postId;this.wod=d.wod;return this},comparator:function(a){return a.get("known_as").replace(/^\s+/,"").toLowerCase()}});CFW.EntryItemView=Backbone.View.extend({tagName:"tr",template:_.template('            <td class="cfw-known-as">                <a href="'+CFW.oxygenTank(CFW_OPTIONS,"athletes_page_permalink","")+'<%- athlete_slug %>" title="view <%- known_as %>\'s profile" target="_blank"><%- known_as %></a>            </td>            <%             if (wod.components && wod.components.length > 1) {                _.each(wod.components, function(component, i, components) {                    var componentResult = _.find(component_results, function(cr) {                        return cr.wp_id == component.wp_id;                    }) || {                        result: "",                        rx: false,                        mods: ""                    };                    var isLast = (i + 1 == components.length);                    %>                     <td class="cfw-component" title="<%- componentResult.result %><%- componentResult.rx ? " [Rx]" : "" %><%- componentResult.mods ? " ("+componentResult.mods+")" : "" %>">                        <%= isLast ? "<div>" : "" %>                        <span class="cfw-result"><%- componentResult.result %></span>                        <span class="cfw-mods">                            <%= componentResult.rx ? "<strong>Rx</strong>" : "" %>                            <%- componentResult.mods %>                        </span>                        <% if (isLast) { %>                            <span class="cfw-more <%= notes ? "cfw-notes-hint" : "" %>">&bull;&bull;&bull;</span>                        <% } %>                        <%= isLast ? "</div>" : "" %>                    </td>                <%                 });            } else {                var componentResult = _.find(component_results, function(cr) {                    return cr.wp_id == (wod.components[0] || {wp_id: "uh oh"}).wp_id;                }) || {                    result: "",                    rx: false,                    mods: ""                };            %>                 <td class="cfw-result" title="<%- componentResult.result %>"><%- componentResult.result %></td>                <td class="cfw-mods" title="<%- componentResult.rx ? "[Rx] " : "" %><%- componentResult.mods %>">                    <div>                        <%= componentResult.rx ? "<strong>Rx</strong> " : "" %><%- componentResult.mods %><span class="cfw-more <%= notes ? "cfw-notes-hint" : "" %>">&bull;&bull;&bull;</span>                    </div>                </td>            <%             }            %>         '),
events:{"click :not(a)":"showDetail"},initialize:function(){this.model.on("change",this.render,this);this.model.on("destroy",this.remove,this);this.model.on("show",this.lookSelected,this);this.model.on("unshow",this.unlookSelected,this);return this.render()},render:function(){this.$el.html(this.template(_.extend({wod:this.options.wod},this.model.toJSON())));return this},lookSelected:function(){this.$el.addClass("cfw-selected")},unlookSelected:function(){this.$el.removeClass("cfw-selected")},addHighlight:function(a){this.$el.addClass("cfw-highlighted").css({backgroundColor:"rgba("+
a.join(",")+",.2)",borderColor:"rgba("+a.join(",")+",.2)"})},removeHighlight:function(){this.$el.removeClass("cfw-highlighted").css({backgroundColor:"transparent",borderColor:"#888"})},showDetail:function(a){this.itemClickDisabled||(a.stopPropagation(),this.model.trigger("show",this.model))}});CFW.WhiteboardPage=Backbone.View.extend({tagName:"div",className:"cfw-page",show:function(){this.$el.addClass("active");var a=this;setTimeout(function(){if(!a.scrollbarReady)a.initScrollbar(),a.scrollbarReady=
!0;a.showScrollbar()},Modernizr.csstransitions?400:0)},hide:function(){this.freezeScrollbar();this.$el.removeClass("active");var a=this;setTimeout(function(){a.hideScrollbar();a.thawScrollbar();a.$el.trigger("cfwhide")},Modernizr.csstransitions?300:0)},initScrollbar:function(){this.$(".cfw-scrollable").scrollbarPaper({parentSelector:".cfw-window",css:CFW.important.css,show:function(a){a.removeClass("cfw-hidden")},hide:function(a){a.addClass("cfw-hidden")}})},showScrollbar:function(){this.$(".cfw-scrollable").scrollbarPaper("show")},
hideScrollbar:function(){this.$(".cfw-scrollable").scrollbarPaper("hide")},freezeScrollbar:function(){this.$(".cfw-scrollable").scrollbarPaper("freeze")},thawScrollbar:function(){this.$(".cfw-scrollable").scrollbarPaper("thaw")}});CFW.EntryListView=CFW.WhiteboardPage.extend({template:_.template('            <table class="cfw-components-<%= wod.components && wod.components.length || 1 %>" cellspacing="0">                <thead>                    <tr>                        <th class="cfw-known-as">Name</th>                        <% _.each(wod.components, function(component) { %>                            <th class="cfw-component" <%= wod.components.length == 1 ? \'colspan="2"\' : "" %> title="<%- component.label %>"><%- component.label %></th>                        <% }); %>                    </tr>                </thead>            </table>            <div class="cfw-scrollable">                <table cellspacing="0" class="cfw-components-<%= wod.components && wod.components.length || 1 %>">                    <tbody>                    </tbody>                </table>            </div>        '),
events:{"touchmove .cfw-scrollable":"disableItemClicks","touchstart .cfw-scrollable":"enableItemClicks"},initialize:function(a){this.entries=a.entries;this.wod=a.wod;this.entryItemViews=[];this.entries.on("add change:known_as remove reset",this.addAll,this);return this.render()},render:function(){this.$el.html(this.template({wod:this.wod}));return this},addOne:function(a){a=new CFW.EntryItemView({model:a,wod:this.wod});this.entryItemViews.push(a);this.$("tbody").append(a.el)},addAll:function(){_.each(this.entryItemViews,
function(a,d,h){a.remove();delete h[d]});this.$("tbody").empty();this.entries.length?this.entries.each(this.addOne,this):this.$("tbody").append(d('                    <tr class="cfw-no-entries">                        <td colspan="100">No one has added an entry yet.<br /><a class="cfw-new-entry">Add yours now!<a></td>                    </tr>                '));this.updateHighlightedUsers()},show:function(){var a=this.$("table").attr("class"),d=this.$el.closest(".cfw-contents");setTimeout(function(){d.addClass(a).data("componentsclass",
a);d.siblings(".cfw-classes").addClass(a)},Modernizr.csstransitions?300:0);CFW.WhiteboardPage.prototype.show.apply(this,arguments)},hide:function(){var a=this.$("table").attr("class");this.$el.closest(".cfw-contents").removeClass(a).removeData("componentsclass").siblings(".cfw-classes").removeClass(a);CFW.WhiteboardPage.prototype.hide.apply(this,arguments)},disableItemClicks:function(){_.each(this.entryItemViews,function(a){a.itemClickDisabled=!0})},enableItemClicks:function(){_.each(this.entryItemViews,
function(a){a.itemClickDisabled=!1})},updateHighlightedUsers:function(){this.entries.each(function(a){a.trigger("removeHighlight")});CFW.users.each(this.addHighlightedUser,this)},addHighlightedUser:function(a){_.each(this.entries.select(function(d){return d.get("email").toLowerCase()==a.get("email").toLowerCase()}),function(d){d.trigger("addHighlight",a.get("highlightColor"))})},removeHighlightedUser:function(a){_.each(this.entries.select(function(d){return d.get("email").toLowerCase()==a.get("email").toLowerCase()}),
function(a){a.trigger("removeHighlight")})}});CFW.EntryDetailView=CFW.WhiteboardPage.extend({template:_.template('            <div class="cfw-entry-detail">                <a class="cfw-back">back</a><a class="cfw-edit">edit</a>                <dl class="cfw-scrollable">                    <dt class="cfw-hidden">Name</dt>                    <dd class="cfw-known-as">                        <%- known_as %>                        <a href="'+CFW.oxygenTank(CFW_OPTIONS,"athletes_page_permalink","")+'<%- athlete_slug %>" title="view <%- known_as %>\'s profile" target="_blank">view profile</a>                    </dd>                    <%                    _.each(wod.components, function(component) {                        var componentResult = _.find(component_results, function(cr) {                            return cr.wp_id == component.wp_id;                        }) || {                            result: "",                            rx: false,                            mods: ""                        };                    %>                        <dt><%= component.label %></dt>                        <dd class="cfw-component">                            <span class="cfw-result"><%- componentResult.result %></span>                            <span class="cfw-mods"><%= componentResult.rx ? "<strong>Rx</strong> " : "" %><%- componentResult.mods %></span>                        </dd>                    <%                    });                    %>                    <dt>Notes</dt>                    <dd class="cfw-notes"><%- notes || "(no data)" %></dd>                </dl>            </div>        '),
events:{"click a.cfw-edit":"edit","click a.cfw-back":"back",cfwhide:"cleanup"},initialize:function(a){this.wod=a.wod;this.model.on("change",this.render,this);this.model.on("destroy",this.hide,this);return this.render()},render:function(){this.$el.html(this.template(_.extend({wod:this.wod},this.model.toJSON())));return this},edit:function(){this.model.trigger("edit",this.model)},back:function(){this.$el.trigger("hideEntryDetails")},cleanup:function(){var a=this;setTimeout(function(){a.model.trigger("unshow",
a.model);a.remove()},0)}});CFW.EntryFormView=Backbone.View.extend({tagName:"form",className:"cfw-scrollable",template:_.template('            <fieldset>                <\!--<h2><%= new_record ? "Add Your Entry" : "Edit Your Entry" %></h2>--\>                <h2><label for="cfw-email">Email Address</label></h2>                <input type="email" id="cfw-email" name="email" placeholder="name@example.com" <%= new_record ? "" : \'value="&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;" disabled="disabled"\' %> />            </fieldset>            <fieldset>                <h2><label for="cfw-known-as">Name</label></h2>                <input type="text" id="cfw-known-as" name="known_as" placeholder="Guest" value="<%- known_as %>" />            </fieldset>            <%            _.each(wod.components, function(component) {                var componentResult = _.find(component_results, function(cr) {                    return cr.wp_id == component.wp_id;                }) || {                    result: "",                    rx: false,                    mods: ""                };            %>                <fieldset>                    <h2><label for="cfw-component-<%= component.wp_id %>-result"><%= component.label %></label></h2>                    <input type="text" id="cfw-component-<%= component.wp_id %>-result" name="component-<%= component.wp_id %>-result" placeholder="How did you do?" value="<%- componentResult.result %>" />                    <div class="cfw-nobr">                        <label for="cfw-component-<%= component.wp_id %>-rx" class="cfw-minority">Rx</label><label for="cfw-component-<%= component.wp_id %>-mods" class="cfw-majority">Modifications</label>                    </div>                    <div class="cfw-nobr">                        <input type="checkbox" id="cfw-component-<%= component.wp_id %>-rx" class="cfw-minority" name="component-<%= component.wp_id %>-rx" <%= componentResult.rx ? \'checked="checked"\' : "" %>                        /><span>or</span><input type="text" id="cfw-component-<%= component.wp_id %>-mods" class="cfw-majority" name="component-<%= component.wp_id %>-mods" placeholder="How did you scale?" value="<%- componentResult.mods %>" />                    </div>                </fieldset>            <%            });            %>            <fieldset class="cfw-last">                <div class="cfw-notes <%= notes ? "cfw-open cfw-opaque" : "" %>">                    <h2><label for="cfw-notes">Notes</label></h2>                    <textarea rows="3" id="cfw-notes" name="notes" placeholder="Notes or Tips for next time?"><%- notes %></textarea>                </div>                <div class="cfw-footer">                    <a class="cfw-add-notes <%= notes ? "cfw-hidden" : "" %>"><label for="cfw-notes"><strong>+</strong> add notes</label></a>                    <input type="submit" value="<%= new_record ? "Submit" : "Save" %>" />                    <input type="reset" value="Cancel" />                </div>            </fieldset>        '),
events:{"focus :input":"scrollToInput",'keyup input[name="email"]':"guessName",'change input[name="email"]':"guessName",'blur input[name="known_as"]':"guessName","click .cfw-add-notes":"showNotesFields",submit:"save",'click input[type="reset"]':"remove"},initialize:function(a){this.entries=a.entries;this.wod=a.wod;return this.render()},render:function(){this.$el.attr("action","javascript://");CFW.important.css.apply(this.$el,["position","absolute",!0]);this.$el.html(this.template(_.extend({wod:this.wod,
new_record:!this.model},(this.model||new CFW.Entry).toJSON())));return this},initScrollbar:function(){this.$el.scrollbarPaper({parentSelector:".cfw-window",css:CFW.important.css,show:function(a){a.removeClass("cfw-hidden")},hide:function(a){a.addClass("cfw-hidden")}})},showScrollbar:function(){this.$el.scrollbarPaper("show")},hideScrollbar:function(){this.$el.scrollbarPaper("hide")},freezeScrollbar:function(){this.$el.scrollbarPaper("freeze")},thawScrollbar:function(){this.$el.scrollbarPaper("thaw")},
scrollToInput:function(a){if(!this.height)this.height=this.$el.parent().height();(a=(d(a.target).position()||{}).top)&&this.$el.animate({scrollTop:a+this.$el.scrollTop()-this.height/2},300)},guessName:function(){var a=this.$('input[name="email"]'),d=this.$('input[name="known_as"]');if(!(d.val().length&&this.lastGuess&&d.val()!=this.lastGuess||d.val().length&&!this.lastGuess)){var h=CFW.users.find(function(c){return c.get("email").toLowerCase()==a.val().toLowerCase()});if(h)d.val(this.lastGuess=h.get("known_as"));
else{h=a.val();if(!_.capitalize)_.capitalize=function(a){return a.substring(0,1).toUpperCase()+a.substring(1)};this.lastGuess=_.capitalize((/[^.@0-9]+/.exec(h)||[""])[0]);d.val(this.lastGuess)}}},showNotesFields:function(){var a=this.$(".cfw-notes").addClass("cfw-open"),d=this.$(".cfw-add-notes").addClass("cfw-transparent");setTimeout(function(){a.addClass("cfw-opaque");d.addClass("cfw-hidden")},Modernizr.csstransitions?200:0)},save:function(a){a.preventDefault();if(!this.isLoading()){var g={email:this.$('input[name="email"]').val(),
known_as:this.$('input[name="known_as"]').val(),component_results:[],notes:this.$('textarea[name="notes"]').val()},h={};this.$('input[name^="component-"]').each(function(){var a=d(this),c=a.attr("name").split("-"),a="checkbox"==a.attr("type")?a.is(":checked"):a.val();h[c[1]]||(h[c[1]]={wp_id:c[1]});h[c[1]][c[2]]=a});_.each(h,function(a){g.component_results.push(a)});var c=this;c.showLoading();c.$(".ajax-error-notice").remove();a=d.extend({},CFW.ajaxOptions,{success:function(){c.hideLoading();c.remove()},
error:function(a,g){c.hideLoading();g&&g.length?c.showValidationErrors(g):c.$(".cfw-footer").after(d('<label class="cfw-invalid ajax-error-notice" style="text-align:center;line-height:1.2;">Oops! There was a problem connecting to the server.  Click <strong>'+c.$('input[type="submit"]').val()+"</strong> to try again or contact athlete support if the problem persists.</label>"))},wait:!0});this.model?this.model.save(g,a):this.entries.create(g,a)||this.showValidationErrors(CFW.Entry.prototype.validate(g))}},
show:function(){var a=this.$el.closest(".cfw-contents"),d=a.data("componentsclass");d&&(a.removeClass(d),a.siblings(".cfw-classes").removeClass(d));var h=this;setTimeout(function(){h.$el.addClass("cfw-translate-oldfashioned")},0);setTimeout(function(){if(!h.scrollbarReady)h.initScrollbar(),h.scrollbarReady=!0;h.showScrollbar();var a=h.$el.find(":input:first")[0];a&&a.focus&&a.focus()},Modernizr.csstransitions?400:0)},showLoading:function(){this.$('input[type="submit"]').addClass("loading")},isLoading:function(){return this.$('input[type="submit"]').hasClass("loading")},
hideLoading:function(){this.$('input[type="submit"]').removeClass("loading").removeAttr("disabled")},showValidationErrors:function(a){var g=this;_.each(a,function(a){g.$('input[name="'+a+'"]').addClass("cfw-invalid").each(function(){d('label[for="'+d(this).attr("id")+'"]').addClass("cfw-invalid")}).one("keydown change",function(){d(this).removeClass("cfw-invalid");d('label[for="'+d(this).attr("id")+'"]').removeClass("cfw-invalid")})})},remove:function(){this.freezeScrollbar();var a=this,d=this.$el.closest(".cfw-contents");
this.$el.removeClass("cfw-translate-oldfashioned");setTimeout(function(){a.hideScrollbar();var h=d.data("componentsclass");h&&(d.addClass(h),d.siblings(".cfw-classes").addClass(h));a.$el.trigger("cfwremove").remove()},Modernizr.csstransitions?300:0)}});CFW.WhiteboardView=Backbone.View.extend({className:"cfw-pane",template:_.template('            <div>                <div class="cfw-window">                    <h2>Entries</h2>                    <a class="cfw-new-entry">+</a>                    <ul class="cfw-classes cfw-<%- allWods.length || 1 %>-classes cfw-components-<%= wod.components && wod.components.length || 1 %>">                        <%                        _.each(allWods, function(w) {                            %><li class="<%- w.wp_id == wod.wp_id ? "cfw-selected" : "" %>"><div>                                <a href="javascript://" data-wp_id="<%- w.wp_id %>" title="<%- w.name %>">                                    <span class="cfw-centered">                                        <span class="cfw-entry-count" data-wp_id="<%- w.wp_id %>"></span>                                        <span class="cfw-link-text"><%- w.name %></span>                                    </span>                                    <span class="cfw-separator"></span>                                </a>                            </div></li><%                        });                        %>                    </ul>                    <div class="cfw-contents"></div>                    <div class="cfw-footer">                        <a href="http://cfwhiteboard.com" target="_blank">                            What Is This?                        </a><a href="mailto:athletesupport@cfwhiteboard.com">                            Email Athlete Support                        </a>                    </div>                </div>            </div>            <a class="cfw-print cfw-admin-tool cfw-hidden" target="_blank">Print</a>        '),
events:{"click .cfw-new-entry:not([disabled])":"newEntry",hideEntryDetails:"hideEntry","cfwremove form":"cleanupEntryForm","click .cfw-classes a:not(.cfw-selected)":"returnToEntryList"},initialize:function(a){this.entries=new CFW.EntryList([],{affiliateId:a.affiliateId,postId:a.postId,wod:a.wod});this.entries.on("add remove reset",this.newEntryCount,this);this.entries.on("edit",this.editEntry,this);this.entries.on("show",this.showEntry,this);this.entries.on("add change:known_as",this.updateUsers,
this);this.render();a.hidden&&this.hide();this.entries.fetch(d.extend({},CFW.ajaxOptions,{data:{postModified:a.postModified}}))},render:function(){this.$el.html(this.template({wod:this.options.wod,allWods:this.options.allWods}));this.entryListView=new CFW.EntryListView({entries:this.entries,wod:this.options.wod});this.$(".cfw-contents").append(this.entryListView.el);this.entryListView.show();"admin"==this.options.authorization&&(this.$(".cfw-print").attr("href",this.entries.url()),this.$(".cfw-admin-tool").removeClass("cfw-hidden"));
return this},attach:function(){this.$children&&this.$el.append(this.$children)},detach:function(){this.$children=this.$el.children();this.$children.detach()},show:function(){this.$el.removeClass("cfw-hidden")},hide:function(){this.$el.addClass("cfw-hidden")},newEntry:function(){this.showEntryForm()},editEntry:function(a){this.showEntryForm(a)},showEntryForm:function(a){this.disableNewEntries();this.formView=new CFW.EntryFormView({entries:this.entries,model:a,wod:this.options.wod});this.$(".cfw-contents").append(this.formView.el);
this.detailView?this.detailView.hideScrollbar():this.entryListView.hideScrollbar();var d=this.formView;setTimeout(function(){d.show()},0)},cleanupEntryForm:function(){this.enableNewEntries();this.detailView?this.detailView.showScrollbar():this.entryListView.showScrollbar();delete this.formView},disableNewEntries:function(){this.$el.find(".cfw-new-entry").attr("disabled",!0)},enableNewEntries:function(){this.$el.find(".cfw-new-entry").removeAttr("disabled")},showEntry:function(a){this.detailView=new CFW.EntryDetailView({model:a,
wod:this.options.wod});this.$(".cfw-contents").append(this.detailView.el);var d=this;setTimeout(function(){d.entryListView.hide();d.detailView.show()},0)},hideEntry:function(){this.detailView.hide();this.entryListView.show();var a=this;setTimeout(function(){delete a.detailView},Modernizr.csstransitions?400:100)},newEntryCount:function(){this.$el.trigger("newEntryCount",[this.options.wod.wp_id,this.entries.length])},updateEntryCount:function(a,g){var h=this.$(".cfw-entry-count");0==h.length&&(h=this.$children.find(".cfw-entry-count"));
1<h.length&&h.each(function(){var c=d(this);c.data("wp_id")==a&&c.text(g).attr("title",""+g+" entries")})},updateUsers:function(a){var d=CFW.users.find(function(d){return d.get("email").toLowerCase()==a.get("email").toLowerCase()});d?d.save({known_as:a.get("known_as"),count:d.get("count")+1}):d=CFW.users.create({email:a.get("email"),known_as:a.get("known_as"),count:1})},returnToEntryList:function(){this.formView?this.formView.remove():this.detailView&&this.hideEntry()}});CFW.WhiteboardButtonView=
Backbone.View.extend({template:_.template('            <h1>Whiteboard <span class="cfw-entry-count-all cfw-hidden"></span></h1>        '),events:{"click h1":"toggleWhiteboard","click .cfw-classes a":"showClass","newEntryCount .cfw-pane":"updateEntryCounts","mouseenter h1":"hoverButton","mouseleave h1":"unhoverButton"},initialize:function(){var a=this.$el.data("cfwhiteboard");this.affiliateId=a.affiliateId;this.postId=a.postId;this.postModified=a.postModified;this.wods=a.wods;this.authorization=this.$el.data("authorization");
return-1<_.indexOf(_.pluck(CFW.instances,"postId"),this.postId)?void 0:this.render()},render:function(){if("embed"==CFW.oxygenTank(CFW_OPTIONS,"position","display",!1)&&1<this.$el.length){this.$el.first().replaceWith(this.$el.last().addClass("cfw-display-embed"));var a=d("<div />").addClass("cfw-clearer");this.$el.last().parent().append(a)}this.$el.first().html(this.template());this.positionWhiteboard();this.whiteboardViews={};var g=this;_.each(g.wods,function(a,c){a.name=a.name.replace(/workout of the day/ig,
"WOD");var d=new CFW.WhiteboardView({affiliateId:g.affiliateId,postId:g.postId,postModified:g.postModified,wod:a,allWods:g.wods,authorization:g.authorization,hidden:0==c?!1:!0});g.$el.last().append(d.el);g.whiteboardViews[a.wp_id]=d;setTimeout(function(){d.detach()},0)});return this},hoverButton:function(a){this.$el.first().find("h1").addClass("cfw-hovering");this.attachWhiteboard(a);this.positionWhiteboard(a)},unhoverButton:function(a){this.$el.first().find("h1").removeClass("cfw-hovering");this.detachWhiteboard(a)},
attachWhiteboard:function(){this.$el.first().hasClass("cfw-attached")||(this.$el.first().addClass("cfw-attached"),_.each(this.whiteboardViews,function(a){a.attach()}))},detachWhiteboard:function(){this.$el.first().hasClass("cfw-attached")&&!this.$el.first().hasClass("cfw-active")&&!this.$el.first().find("h1").hasClass("cfw-hovering")&&(this.$el.first().removeClass("cfw-attached"),_.each(this.whiteboardViews,function(a){a.detach()}))},toggleWhiteboard:function(a){this.$el.is(".cfw-active")?this.closeWhiteboard():
this.openWhiteboard();a.preventDefault()},openWhiteboard:function(){this.$el.addClass("cfw-active").removeClass("cfw-postactive")},closeWhiteboard:function(){this.$el.addClass("cfw-postactive").removeClass("cfw-active");var a=this;setTimeout(function(){a.$el.removeClass("cfw-postactive");a.detachWhiteboard()},Modernizr.csstransitions?300:0)},positionWhiteboard:function(){if("embed"==CFW.oxygenTank(CFW_OPTIONS,"position","display",!1))this.$el.last().addClass("cfw-active");else if(this.$el.last().parent().is("body")){var a=
this.$el.first().offset(),g={position:"absolute",margin:"0",top:a.top+"px"};this.$el.last().is(".position-inline, .position-block, .position-floatleft")?g.left=a.left+"px":(g.right=d(document).width()-this.$el.first().outerWidth()-a.left,g.right+="px");CFW.important.css.apply(this.$el.last(),[g,!0])}},showClass:function(a){var g=d(a.target).closest("a").data("wp_id");_.each(this.whiteboardViews,function(a,c){c==g?a.show():a.hide()})},updateEntryCounts:function(a,d,h){this.whiteboardViews[d.toString()].entryCount=
h;_.each(this.whiteboardViews,function(a){a.updateEntryCount(d,h)});a=_.inject(this.whiteboardViews,function(a,d){return a+(d.entryCount||0)},0);this.$(".cfw-entry-count-all").text(a).attr("title",""+a+" entries").removeClass("cfw-hidden")}});CFW.instances=[];setTimeout(function(){d(".cfwhiteboard").each(function(){var a=d(this),g=a.closest("a");g.length&&g.before(a);if(!1!=CFW.oxygenTank(CFW_OPTIONS,"position",!1)){g=a.closest(CFW_OPTIONS.position.parent).find(CFW_OPTIONS.position.target);if(g.length)switch(CFW_OPTIONS.position.insertion){case "append":g.append(a);
break;case "before":g.before(a);break;case "after":g.after(a);break;default:g.prepend(a)}switch(CFW_OPTIONS.position.alignment){case "inline":a.addClass("position-inline");break;case "block":a.addClass("position-block");break;case "floatleft":a.addClass("position-floatleft")}CFW_OPTIONS.position.margin&&CFW.important.css.apply(a,[{margin:CFW_OPTIONS.position.margin},!0])}a=a.add(a.clone().appendTo(document.body));CFW.instances.push(new CFW.WhiteboardButtonView({el:a}))});"embed"!=CFW.oxygenTank(CFW_OPTIONS,
"position","display",!1)&&(_.each(CFW.instances,function(a){a.$el.on("click",function(a){a.stopPropagation()})}),d(document.body).on("click",function(){_.each(CFW.instances,function(a){a.closeWhiteboard()})}))},d.browser.msie?1500:0)});
